# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR The FreeBSD Project
# This file is distributed under the same license as the FreeBSD Documentation package.
# Chen Jingge <mariocanfly@hotmail.com>, 2025.
msgid ""
msgstr ""
"Project-Id-Version: FreeBSD Documentation VERSION\n"
"POT-Creation-Date: 2025-05-01 19:56-0300\n"
"PO-Revision-Date: 2025-08-31 04:45+0000\n"
"Last-Translator: Chen Jingge <mariocanfly@hotmail.com>\n"
"Language-Team: Chinese (Simplified) <https://translate-dev.freebsd.org/"
"projects/documentation/bookshandbookdisks_index/zh_CN/>\n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"
"X-Generator: Weblate 4.17\n"

#. type: YAML Front Matter: description
#: documentation/content/en/books/handbook/disks/_index.adoc:1
#, no-wrap
msgid "This chapter covers the use of disks and storage media in FreeBSD. This includes SCSI and IDE disks, CD and DVD media, memory-backed disks, and USB storage devices."
msgstr ""

#. type: YAML Front Matter: part
#: documentation/content/en/books/handbook/disks/_index.adoc:1
#, no-wrap
msgid "Part III. System Administration"
msgstr ""

#. type: YAML Front Matter: title
#: documentation/content/en/books/handbook/disks/_index.adoc:1
#, no-wrap
msgid "Chapter 20. Storage"
msgstr ""

#. type: Title =
#: documentation/content/en/books/handbook/disks/_index.adoc:15
#, no-wrap
msgid "Storage"
msgstr "存储"

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:53
#, no-wrap
msgid "Synopsis"
msgstr "概要"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:57
msgid ""
"This chapter covers the use of disks and storage media in FreeBSD.  This "
"includes SCSI and IDE disks, CD and DVD media, memory-backed disks, and USB "
"storage devices."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:59
msgid "After reading this chapter, you will know:"
msgstr "读完本章节，你将会知道："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:61
msgid "How to add additional hard disks to a FreeBSD system."
msgstr "如何在您的系统上增加硬盘。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:62
msgid "How to grow the size of a disk's partition on FreeBSD."
msgstr "如何增加分区空间。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:63
msgid "How to configure FreeBSD to use USB storage devices."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:64
msgid "How to use CD and DVD media on a FreeBSD system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:65
msgid "How to use the backup programs available under FreeBSD."
msgstr "如何备份 FreeBSD 上的程序。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:66
msgid "How to set up memory disks."
msgstr "如何设置内存盘。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:67
msgid "What file system snapshots are and how to use them efficiently."
msgstr "文件系统快照是什么？如何有效地使用它们。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:68
msgid "How to use quotas to limit disk space usage."
msgstr "如何使用配额来限制磁盘空间的使用。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:69
msgid "How to encrypt disks and swap to secure them against attackers."
msgstr "如何加密磁盘分区和交换空间以应对攻击者。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:70
msgid "How to configure a highly available storage network."
msgstr "如可配置一个高可用的存储网络。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:72
msgid "Before reading this chapter, you should:"
msgstr "在阅读这个章节之前，您应当："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:74
msgid ""
"Know how to crossref:kernelconfig[kernelconfig,configure and install a new "
"FreeBSD kernel]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:76
#, no-wrap
msgid "Adding Disks"
msgstr "添加磁盘"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:81
msgid ""
"This section describes how to add a new SATA disk to a machine that "
"currently only has a single drive.  First, turn off the computer and install "
"the drive in the computer following the instructions of the computer, "
"controller, and drive manufacturers.  Reboot the system and become `root`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:84
msgid ""
"Inspect [.filename]#/var/run/dmesg.boot# to ensure the new disk was found.  "
"In this example, the newly added SATA drive will appear as [.filename]#ada1#."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:87
msgid ""
"For this example, a single large partition will be created on the new disk.  "
"The https://en.wikipedia.org/wiki/GUID_Partition_Table[GPT] partitioning "
"scheme will be used in preference to the older and less versatile MBR scheme."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:92
msgid ""
"If the disk to be added is not blank, old partition information can be "
"removed with `gpart delete`.  See man:gpart[8] for details."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:96
#, fuzzy
#| msgid ""
#| "The partition scheme is created, and then a single partition is added. To "
#| "improve performance on newer disks with larger hardware block sizes, the "
#| "partition is aligned to one megabyte boundaries:"
msgid ""
"The partition scheme is created, and then a single partition is added.  To "
"improve performance on newer disks with larger hardware block sizes, the "
"partition is aligned to one megabyte boundaries:"
msgstr ""
"创建分区方案，然后添加单个分区。为了提高具有较大硬件块大小的较新磁盘上的性"
"能，分区将与1M block size对齐："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:101
#, no-wrap
msgid ""
"# gpart create -s GPT ada1\n"
"# gpart add -t freebsd-ufs -a 1M ada1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:105
msgid ""
"Depending on use, several smaller partitions may be desired.  See man:"
"gpart[8] for options to create partitions smaller than a whole disk."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:107
msgid "The disk partition information can be viewed with `gpart show`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:115
#, no-wrap
msgid ""
"% gpart show ada1\n"
"=>        34  1465146988  ada1  GPT  (699G)\n"
"          34        2014        - free -  (1.0M)\n"
"        2048  1465143296     1  freebsd-ufs  (699G)\n"
"  1465145344        1678        - free -  (839K)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:118
msgid "A file system is created in the new partition on the new disk:"
msgstr "在磁盘分区上创建文件系统："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:122
#, no-wrap
msgid "# newfs -U /dev/ada1p1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:125
msgid ""
"An empty directory is created as a _mountpoint_, a location for mounting the "
"new disk in the original disk's file system:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:129
#, no-wrap
msgid "# mkdir /newdisk\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:132
#, fuzzy
msgid ""
"Finally, an entry is added to [.filename]#/etc/fstab# so the new disk will "
"be mounted automatically at startup:"
msgstr ""
"最后在<filename>/etc/fstab</filename>添加一条记录，以后该磁盘在系统启用时就会"
"自动挂载："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:136
#, fuzzy, no-wrap
msgid "/dev/ada1p1\t/newdisk\tufs\trw\t2\t2\n"
msgstr "/dev/ada1p1\t/newdisk\tufs\trw\t2\t2\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:139
msgid "The new disk can be mounted manually, without restarting the system:"
msgstr "可以手动装载新磁盘，无需重启系统："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:143
#, no-wrap
msgid "# mount /newdisk\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:146
#, no-wrap
msgid "Resizing and Growing Disks"
msgstr "调整或增加磁盘"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:152
msgid ""
"A disk's capacity can increase without any changes to the data already "
"present.  This happens commonly with virtual machines, when the virtual disk "
"turns out to be too small and is enlarged.  Sometimes a disk image is "
"written to a USB memory stick, but does not use the full capacity.  Here we "
"describe how to resize or _grow_ disk contents to take advantage of "
"increased capacity."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:155
msgid ""
"Determine the device name of the disk to be resized by inspecting [."
"filename]#/var/run/dmesg.boot#.  In this example, there is only one SATA "
"disk in the system, so the drive will appear as [.filename]#ada0#."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:157
msgid "List the partitions on the disk to see the current configuration:"
msgstr "查看当前磁盘的分区状况："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:166
#, no-wrap
msgid ""
"# gpart show ada0\n"
"=>      34  83886013  ada0  GPT  (48G) [CORRUPT]\n"
"        34       128     1  freebsd-boot  (64k)\n"
"       162  79691648     2  freebsd-ufs  (38G)\n"
"  79691810   4194236     3  freebsd-swap  (2G)\n"
"  83886046         1        - free -  (512B)\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:172
msgid ""
"If the disk was formatted with the https://en.wikipedia.org/wiki/"
"GUID_Partition_Table[GPT] partitioning scheme, it may show as \"corrupted\" "
"because the GPT backup partition table is no longer at the end of the "
"drive.  Fix the backup partition table with `gpart`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:177
#, no-wrap
msgid ""
"# gpart recover ada0\n"
"ada0 recovered\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:182
msgid ""
"Now the additional space on the disk is available for use by a new "
"partition, or an existing partition can be expanded:"
msgstr "现在，新分区可以使用添加的磁盘空间，现有分区也可以使用新空间进行扩展："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:191
#, no-wrap
msgid ""
"# gpart show ada0\n"
"=>       34  102399933  ada0  GPT  (48G)\n"
"         34        128     1  freebsd-boot  (64k)\n"
"        162   79691648     2  freebsd-ufs  (38G)\n"
"   79691810    4194236     3  freebsd-swap  (2G)\n"
"   83886046   18513921        - free -  (8.8G)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:196
#, fuzzy
#| msgid ""
#| "Partitions can only be resized into contiguous free space. Here, the last "
#| "partition on the disk is the swap partition, but the second partition is "
#| "the one that needs to be resized. Swap partitions only contain temporary "
#| "data, so it can safely be unmounted, deleted, and then recreate the third "
#| "partition after resizing the second partition."
msgid ""
"Partitions can only be resized into contiguous free space.  Here, the last "
"partition on the disk is the swap partition, but the second partition is the "
"one that needs to be resized.  Swap partitions only contain temporary data, "
"so it can safely be unmounted, deleted, and then recreate the third "
"partition after resizing the second partition."
msgstr ""
"分区只能调整为连续的可用空间。在这里，磁盘上的最后一个分区是交换分区，但第二"
"个分区是需要调整大小的分区。交换分区只包含临时数据，因此可以安全地卸载、删除"
"第三个分区，然后在调整第二个分区的大小后重新创建第三个分区。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:198
msgid "Disable the swap partition:"
msgstr "停用交换分区："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:202
#, no-wrap
msgid "# swapoff /dev/ada0p3\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:205
msgid ""
"Delete the third partition, specified by the `-i` flag, from the disk _ada0_."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:215
#, no-wrap
msgid ""
"# gpart delete -i 3 ada0\n"
"ada0p3 deleted\n"
"# gpart show ada0\n"
"=>       34  102399933  ada0  GPT  (48G)\n"
"         34        128     1  freebsd-boot  (64k)\n"
"        162   79691648     2  freebsd-ufs  (38G)\n"
"   79691810   22708157        - free -  (10G)\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:223
#, fuzzy
msgid ""
"There is risk of data loss when modifying the partition table of a mounted "
"file system.  It is best to perform the following steps on an unmounted file "
"system while running from a live CD-ROM or USB device.  However, if "
"absolutely necessary, a mounted file system can be resized after disabling "
"GEOM safety features:"
msgstr ""
"对于已挂载的分区，修改分区表有造成数据丢失的风险。所以尽量避免在已挂载的设备"
"上进行分区修改操作。如果非要在已挂载的分区上修改分区表，需要禁用 GEMO 安全功"
"能："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:227
#, no-wrap
msgid "# sysctl kern.geom.debugflags=16\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:236
#, fuzzy
msgid ""
"Resize the partition, leaving room to recreate a swap partition of the "
"desired size.  The partition to resize is specified with `-i`, and the new "
"desired size with `-s`.  Optionally, alignment of the partition is "
"controlled with `-a`.  This only modifies the size of the partition.  The "
"file system in the partition will be expanded in a separate step."
msgstr ""
"调整分区大小，留出一部分空间创建交换分区。使用<option>-i</option>选定要修改的"
"分区，使用<option>-s</option>设置新的分区大小，使用<option>-a</option>设置分"
"区对齐大小。这步只会改变分区的大小，分区的文件系统设置将在其他步骤中进行。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:246
#, no-wrap
msgid ""
"# gpart resize -i 2 -s 47G -a 4k ada0\n"
"ada0p2 resized\n"
"# gpart show ada0\n"
"=>       34  102399933  ada0  GPT  (48G)\n"
"         34        128     1  freebsd-boot  (64k)\n"
"        162   98566144     2  freebsd-ufs  (47G)\n"
"   98566306    3833661        - free -  (1.8G)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:250
#, fuzzy
msgid ""
"Recreate the swap partition and activate it.  If no size is specified with `-"
"s`, all remaining space is used:"
msgstr ""
"重新创建交换分区并激活它。如果未使用<option>-s</option>指定大小，交换分区将使"
"用全部剩余空间："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:261
#, no-wrap
msgid ""
"# gpart add -t freebsd-swap -a 4k ada0\n"
"ada0p3 added\n"
"# gpart show ada0\n"
"=>       34  102399933  ada0  GPT  (48G)\n"
"         34        128     1  freebsd-boot  (64k)\n"
"        162   98566144     2  freebsd-ufs  (47G)\n"
"   98566306    3833661     3  freebsd-swap  (1.8G)\n"
"# swapon /dev/ada0p3\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:264
msgid ""
"Grow the UFS file system to use the new capacity of the resized partition:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:274
#, no-wrap
msgid ""
"# growfs /dev/ada0p2\n"
"Device is mounted read-write; resizing will result in temporary write suspension for /.\n"
"It's strongly recommended to make a backup before growing the file system.\n"
"OK to grow file system on /dev/ada0p2, mounted on /, from 38GB to 47GB? [Yes/No] Yes\n"
"super-block backups (for fsck -b #) at:\n"
" 80781312, 82063552, 83345792, 84628032, 85910272, 87192512, 88474752,\n"
" 89756992, 91039232, 92321472, 93603712, 94885952, 96168192, 97450432\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:277
msgid ""
"If the file system is ZFS, the resize is triggered by running the `online` "
"subcommand with `-e`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:281
#, no-wrap
msgid "# zpool online -e zroot /dev/ada0p2\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:284
msgid ""
"Both the partition and the file system on it have now been resized to use "
"the newly-available disk space."
msgstr "这样，文件系统和分区就都调整好了。"

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:286
#, no-wrap
msgid "USB Storage Devices"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:290
msgid ""
"Many external storage solutions, such as hard drives, USB thumbdrives, and "
"CD and DVD burners, use the Universal Serial Bus (USB).  FreeBSD provides "
"support for USB 1.x, 2.0, and 3.0 devices."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:295
msgid ""
"USB 3.0 support is not compatible with some hardware, including Haswell "
"(Lynx point) chipsets.  If FreeBSD boots with a `failed with error 19` "
"message, disable xHCI/USB3 in the system BIOS."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:299
msgid ""
"Support for USB storage devices is built into the [.filename]#GENERIC# "
"kernel.  For a custom kernel, be sure that the following lines are present "
"in the kernel configuration file:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:312
#, fuzzy, no-wrap
msgid ""
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device da\t# Direct Access (disks)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device uhci\t# provides USB 1.x support\n"
"device ohci\t# provides USB 1.x support\n"
"device ehci\t# provides USB 2.0 support\n"
"device xhci\t# provides USB 3.0 support\n"
"device usb\t# USB Bus (required)\n"
"device umass\t# Disks/Mass storage - Requires scbus and da\n"
"device cd\t# needed for CD and DVD burners\n"
msgstr ""
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device da\t# Direct Access (disks)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device uhci\t# provides USB 1.x support\n"
"device ohci\t# provides USB 1.x support\n"
"device ehci\t# provides USB 2.0 support\n"
"device xhci\t# provides USB 3.0 support\n"
"device usb\t# USB Bus (required)\n"
"device umass\t# Disks/Mass storage - Requires scbus and da\n"
"device cd\t# needed for CD and DVD burners\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:316
msgid ""
"FreeBSD uses the man:umass[4] driver which uses the SCSI subsystem to access "
"USB storage devices.  Since any USB device will be seen as a SCSI device by "
"the system, if the USB device is a CD or DVD burner, do _not_ include "
"`device atapicam` in a custom kernel configuration file."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:318
msgid ""
"The rest of this section demonstrates how to verify that a USB storage "
"device is recognized by FreeBSD and how to configure the device so that it "
"can be used."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:319
#, no-wrap
msgid "Device Configuration"
msgstr "设备配置"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:324
msgid ""
"To test the USB configuration, plug in the USB device.  Use `dmesg` to "
"confirm that the drive appears in the system message buffer.  It should look "
"something like this:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:336
#, fuzzy, no-wrap
msgid ""
"umass0: <STECH Simple Drive, class 0/0, rev 2.00/1.04, addr 3> on usbus0\n"
"umass0:  SCSI over Bulk-Only; quirks = 0x0100\n"
"umass0:4:0:-1: Attached to scbus4\n"
"da0 at umass-sim0 bus 0 scbus4 target 0 lun 0\n"
"da0: <STECH Simple Drive 1.04> Fixed Direct Access SCSI-4 device\n"
"da0: Serial Number WD-WXE508CAN263\n"
"da0: 40.000MB/s transfers\n"
"da0: 152627MB (312581808 512 byte sectors: 255H 63S/T 19457C)\n"
"da0: quirks=0x2<NO_6_BYTE>\n"
msgstr ""
"umass0: &lt;STECH Simple Drive, class 0/0, rev 2.00/1.04, addr 3&gt; on usbus0\n"
"umass0:  SCSI over Bulk-Only; quirks = 0x0100\n"
"umass0:4:0:-1: Attached to scbus4\n"
"da0 at umass-sim0 bus 0 scbus4 target 0 lun 0\n"
"da0: &lt;STECH Simple Drive 1.04&gt; Fixed Direct Access SCSI-4 device\n"
"da0: Serial Number WD-WXE508CAN263\n"
"da0: 40.000MB/s transfers\n"
"da0: 152627MB (312581808 512 byte sectors: 255H 63S/T 19457C)\n"
"da0: quirks=0x2&lt;NO_6_BYTE&gt;\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:339
#, fuzzy
msgid ""
"The brand, device node ([.filename]#da0#), speed, and size will differ "
"according to the device."
msgstr ""
"当然啦，商标，设备标识 (<filename>da0</filename>) 和其它的细节信息会根据您的"
"配置不同 而有所不同。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:341
msgid ""
"Since the USB device is seen as a SCSI one, `camcontrol` can be used to list "
"the USB storage devices attached to the system:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:346
#, no-wrap
msgid ""
"# camcontrol devlist\n"
"<STECH Simple Drive 1.04>          at scbus4 target 0 lun 0 (pass3,da0)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:350
msgid ""
"Alternately, `usbconfig` can be used to list the device.  Refer to man:"
"usbconfig[8] for more information about this command."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:355
#, no-wrap
msgid ""
"# usbconfig\n"
"ugen0.3: <Simple Drive STECH> at usbus0, cfg=0 md=HOST spd=HIGH (480Mbps) pwr=ON (2mA)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:359
msgid ""
"If the device has not been formatted, refer to crossref:disks[disks-adding, "
"Adding Disks] for instructions on how to format and create partitions on the "
"USB drive.  If the drive comes with a file system, it can be mounted by "
"`root` using the instructions in crossref:basics[mount-unmount,“Mounting and "
"Unmounting File Systems”]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:364
#, fuzzy
msgid ""
"Allowing untrusted users to mount arbitrary media, by enabling `vfs."
"usermount` as described below, should not be considered safe from a security "
"point of view.  Most file systems were not built to safeguard against "
"malicious devices."
msgstr ""
"允许非可信用户挂载任意介质，可以通过<literal>vfs.usermount</literal>来启用此"
"功能（），从安全角度来看是很不保险的。FreeBSD 中的绝大多数文件系统并不提供针"
"对恶意设备的内建防护能力。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:368
msgid ""
"To make the device mountable as a normal user, one solution is to make all "
"users of the device a member of the `operator` group using man:pw[8].  Next, "
"ensure that `operator` is able to read and write the device by adding these "
"lines to [.filename]#/etc/devfs.rules#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:373
#, fuzzy, no-wrap
msgid ""
"[localrules=5]\n"
"add path 'da*' mode 0660 group operator\n"
msgstr ""
"[localrules=5]\n"
"add path 'da*' mode 0660 group operator\n"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:378
msgid ""
"If internal SCSI disks are also installed in the system, change the second "
"line as follows:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:382
#, no-wrap
msgid "add path 'da[3-9]*' mode 0660 group operator\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:387
msgid ""
"This will exclude the first three SCSI disks ([.filename]#da0# to [."
"filename]#da2#) from belonging to the `operator` group.  Replace _3_ with "
"the number of internal SCSI disks.  Refer to man:devfs.rules[5] for more "
"information about this file."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:390
msgid "Next, enable the ruleset in [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:394
#, fuzzy, no-wrap
msgid "devfs_system_ruleset=\"localrules\"\n"
msgstr "devfs_system_ruleset=\"localrules\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:397
#, fuzzy
msgid ""
"Then, instruct the system to allow regular users to mount file systems by "
"adding the following line to [.filename]#/etc/sysctl.conf#:"
msgstr ""
"接下来， 需要配置内核， 令普通用户能够挂接文件系统。 最简单的方法是将下面的配"
"置加入到 <filename>/etc/sysctl.conf</filename>："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:401
#, fuzzy, no-wrap
msgid "vfs.usermount=1\n"
msgstr "vfs.usermount=1\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:404
msgid ""
"Since this only takes effect after the next reboot, use `sysctl` to set this "
"variable now:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:409
#, no-wrap
msgid ""
"# sysctl vfs.usermount=1\n"
"vfs.usermount: 0 -> 1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:415
msgid ""
"The final step is to create a directory where the file system is to be "
"mounted.  This directory needs to be owned by the user that is to mount the "
"file system.  One way to do that is for `root` to create a subdirectory "
"owned by that user as [.filename]#/mnt/username#.  In the following example, "
"replace _username_ with the login name of the user and _usergroup_ with the "
"user's primary group:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:420
#, no-wrap
msgid ""
"# mkdir /mnt/username\n"
"# chown username:usergroup /mnt/username\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:424
msgid ""
"Suppose a USB thumbdrive is plugged in, and a device [.filename]#/dev/da0s1# "
"appears.  If the device is formatted with a FAT file system, the user can "
"mount it using:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:428
#, no-wrap
msgid "% mount -t msdosfs -o -m=644,-M=755 /dev/da0s1 /mnt/username\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:431
msgid "Before the device can be unplugged, it _must_ be unmounted first:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:435
#, no-wrap
msgid "% umount /mnt/username\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:438
msgid ""
"After device removal, the system message buffer will show messages similar "
"to the following:"
msgstr ""
"如果拔出设备 (必须首先将其对应的磁盘卷卸下)， 则您会在系统消息缓冲区中看到类"
"似下面的信息："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:445
#, fuzzy, no-wrap
msgid ""
"umass0: at uhub3, port 2, addr 3 (disconnected)\n"
"da0 at umass-sim0 bus 0 scbus4 target 0 lun 0\n"
"da0: <STECH Simple Drive 1.04> s/n WD-WXE508CAN263          detached\n"
"(da0:umass-sim0:0:0:0): Periph destroyed\n"
msgstr ""
"umass0: at uhub3, port 2, addr 3 (disconnected)\n"
"da0 at umass-sim0 bus 0 scbus4 target 0 lun 0\n"
"da0: &lt;STECH Simple Drive 1.04&gt; s/n WD-WXE508CAN263          detached\n"
"(da0:umass-sim0:0:0:0): Periph destroyed\n"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:447
#, no-wrap
msgid "Automounting Removable Media"
msgstr "自动挂载可移动设备"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:450
msgid ""
"USB devices can be automatically mounted by uncommenting this line in [."
"filename]#/etc/auto_master#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:454
#, fuzzy, no-wrap
msgid "/media\t\t-media\t\t-nosuid\n"
msgstr "/media\t\t-media\t\t-nosuid\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:457
msgid "Then add these lines to [.filename]#/etc/devd.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:465
#, fuzzy, no-wrap
msgid ""
"notify 100 {\n"
"\tmatch \"system\" \"GEOM\";\n"
"\tmatch \"subsystem\" \"DEV\";\n"
"\taction \"/usr/sbin/automount -c\";\n"
"};\n"
msgstr ""
"notify 100 {\n"
"\tmatch \"system\" \"GEOM\";\n"
"\tmatch \"subsystem\" \"DEV\";\n"
"\taction \"/usr/sbin/automount -c\";\n"
"};\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:468
msgid ""
"Reload the configuration if man:autofs[5] and man:devd[8] are already "
"running:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:473
#, no-wrap
msgid ""
"# service automount restart\n"
"# service devd restart\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:476
msgid ""
"man:autofs[5] can be set to start at boot by adding this line to [."
"filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:480
#, fuzzy, no-wrap
msgid "autofs_enable=\"YES\"\n"
msgstr "autofs_enable=\"YES\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:483
msgid "man:autofs[5] requires man:devd[8] to be enabled, as it is by default."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:485
msgid "Start the services immediately with:"
msgstr "用下列命令启动这些服务："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:492
#, no-wrap
msgid ""
"# service automount start\n"
"# service automountd start\n"
"# service autounmountd start\n"
"# service devd start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:497
#, fuzzy
msgid ""
"Each file system that can be automatically mounted appears as a directory in "
"[.filename]#/media/#.  The directory is named after the file system label.  "
"If the label is missing, the directory is named after the device node."
msgstr ""
"每个可以自动挂载的文件系统都显示为 <filename>/media/</filename> 中的目录。该"
"目录以文件系统标签命名。如果缺少标签, 则该目录将以设备节点命名。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:500
#, fuzzy
#| msgid ""
#| "The file system is transparently mounted on the first access, and "
#| "unmounted after a period of inactivity. Automounted drives can also be "
#| "unmounted manually:"
msgid ""
"The file system is transparently mounted on the first access, and unmounted "
"after a period of inactivity.  Automounted drives can also be unmounted "
"manually:"
msgstr ""
"文件系统在第一次访问上透明地装载，并在一段时间不活动后卸载。也可以手动卸载自"
"动装载的驱动器："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:504
#, no-wrap
msgid "# automount -fu\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:508
msgid ""
"This mechanism is typically used for memory cards and USB memory sticks.  It "
"can be used with any block device, including optical drives or iSCSILUNs."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:510
#, no-wrap
msgid "Creating and Using CD Media"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:516
#, fuzzy
msgid ""
"Compact Disc (CD) media provide a number of features that differentiate them "
"from conventional disks.  They are designed so that they can be read "
"continuously without delays to move the head between tracks.  While CD media "
"do have tracks, these refer to a section of data to be read continuously, "
"and not a physical property of the disk.  The ISO 9660 file system was "
"designed to deal with these differences."
msgstr ""
"光盘 （<acronym>CD</acronym>）和磁盘不同在于光盘可以连续读取，不需要频繁移动"
"磁头。虽然<acronym>CD</acronym>介质确实有轨道，但这些轨道是指要连续读取的一部"
"分数据，而不是磁盘的物理属性。<acronym>ISO</acronym> 9660 文件系统旨在处理这"
"些差异。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:520
msgid ""
"The FreeBSD Ports Collection provides several utilities for burning and "
"duplicating audio and data CDs.  This chapter demonstrates the use of "
"several command line utilities.  For CD burning software with a graphical "
"utility, consider installing the package:sysutils/xcdroast[] or package:"
"sysutils/k3b[] packages or ports."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:522
#, no-wrap
msgid "Supported Devices"
msgstr "支持的设备"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:526
msgid ""
"The [.filename]#GENERIC# kernel provides support for SCSI, USB, and ATAPICD "
"readers and burners.  If a custom kernel is used, the options that need to "
"be present in the kernel configuration file vary by the type of device."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:528
msgid "For a SCSI burner, make sure these options are present:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:535
#, fuzzy, no-wrap
msgid ""
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device da\t# Direct Access (disks)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device cd\t# needed for CD and DVD burners\n"
msgstr ""
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device da\t# Direct Access (disks)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device cd\t# needed for CD and DVD burners\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:538
msgid "For a USB burner, make sure these options are present:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:551
#, fuzzy, no-wrap
msgid ""
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device da\t# Direct Access (disks)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device cd\t# needed for CD and DVD burners\n"
"device uhci\t# provides USB 1.x support\n"
"device ohci\t# provides USB 1.x support\n"
"device ehci\t# provides USB 2.0 support\n"
"device xhci\t# provides USB 3.0 support\n"
"device usb\t# USB Bus (required)\n"
"device umass\t# Disks/Mass storage - Requires scbus and da\n"
msgstr ""
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device da\t# Direct Access (disks)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device cd\t# needed for CD and DVD burners\n"
"device uhci\t# provides USB 1.x support\n"
"device ohci\t# provides USB 1.x support\n"
"device ehci\t# provides USB 2.0 support\n"
"device xhci\t# provides USB 3.0 support\n"
"device usb\t# USB Bus (required)\n"
"device umass\t# Disks/Mass storage - Requires scbus and da\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:554
msgid "For an ATAPI burner, make sure these options are present:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:561
#, fuzzy, no-wrap
msgid ""
"device ata\t# Legacy ATA/SATA controllers\n"
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device cd\t# needed for CD and DVD burners\n"
msgstr ""
"device ata\t# Legacy ATA/SATA controllers\n"
"device scbus\t# SCSI bus (required for ATA/SCSI)\n"
"device pass\t# Passthrough device (direct ATA/SCSI access)\n"
"device cd\t# needed for CD and DVD burners\n"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:566
msgid ""
"On FreeBSD versions prior to 10.x, this line is also needed in the kernel "
"configuration file if the burner is an ATAPI device:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:570
#, fuzzy, no-wrap
msgid "device atapicam\n"
msgstr "device atapicam\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:573
#, fuzzy
msgid ""
"Alternately, this driver can be loaded at boot time by adding the following "
"line to [.filename]#/boot/loader.conf#:"
msgstr ""
"您也可以将此行添加到<filename>/boot/loader.conf</filename>让系统在启动时加载 "
"ATAPI 驱动："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:577
#, fuzzy, no-wrap
msgid "atapicam_load=\"YES\"\n"
msgstr "atapicam_load=\"YES\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:580
msgid ""
"This will require a reboot of the system as this driver can only be loaded "
"at boot time."
msgstr "添加完成后需重启系统加载驱动。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:584
#, fuzzy
msgid ""
"To verify that FreeBSD recognizes the device, run `dmesg` and look for an "
"entry for the device.  On systems prior to 10.x, the device name in the "
"first line of the output will be [.filename]#acd0# instead of [."
"filename]#cd0#."
msgstr ""
"要验证 FreeBSD 是否识别该设备， 请运行 <command>dmesg</command> 并查找该设备"
"的条目。在 10.x 之前的系统中， 输出的第一行中的设备名称将是 <filename>acd0</"
"filename>， 而不是 <filename>cd0</filename>。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:593
#, no-wrap
msgid ""
"% dmesg | grep cd\n"
"cd0 at ahcich1 bus 0 scbus1 target 0 lun 0\n"
"cd0: <HL-DT-ST DVDRAM GU70N LT20> Removable CD-ROM SCSI-0 device\n"
"cd0: Serial Number M3OD3S34152\n"
"cd0: 150.000MB/s transfers (SATA 1.x, UDMA6, ATAPI 12bytes, PIO 8192bytes)\n"
"cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:596
#, no-wrap
msgid "Burning a CD"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:600
msgid ""
"In FreeBSD, `cdrecord` can be used to burn CDs.  This command is installed "
"with the package:sysutils/cdrtools[] package or port."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:603
msgid ""
"While `cdrecord` has many options, basic usage is simple.  Specify the name "
"of the ISO file to burn and, if the system has multiple burner devices, "
"specify the name of the device to use:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:607
#, no-wrap
msgid "# cdrecord dev=device imagefile.iso\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:610
msgid ""
"To determine the device name of the burner, use `-scanbus` which might "
"produce results like this:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:634
#, fuzzy, no-wrap
msgid ""
"# cdrecord -scanbus\n"
"ProDVD-ProBD-Clone 3.00 (amd64-unknown-freebsd10.0) Copyright (C) 1995-2010 Jörg Schilling\n"
"Using libscg version 'schily-0.9'\n"
"scsibus0:\n"
"        0,0,0     0) 'SEAGATE ' 'ST39236LW       ' '0004' Disk\n"
"        0,1,0     1) 'SEAGATE ' 'ST39173W        ' '5958' Disk\n"
"        0,2,0     2) *\n"
"        0,3,0     3) 'iomega  ' 'jaz 1GB         ' 'J.86' Removable Disk\n"
"        0,4,0     4) 'NEC     ' 'CD-ROM DRIVE:466' '1.26' Removable CD-ROM\n"
"        0,5,0     5) *\n"
"        0,6,0     6) *\n"
"        0,7,0     7) *\n"
"scsibus1:\n"
"        1,0,0   100) *\n"
"        1,1,0   101) *\n"
"        1,2,0   102) *\n"
"        1,3,0   103) *\n"
"        1,4,0   104) *\n"
"        1,5,0   105) 'YAMAHA  ' 'CRW4260         ' '1.0q' Removable CD-ROM\n"
"        1,6,0   106) 'ARTEC   ' 'AM12S           ' '1.06' Scanner\n"
"        1,7,0   107) *\n"
msgstr ""
"<prompt>#</prompt> <userinput>cdrecord -scanbus</userinput>\n"
"ProDVD-ProBD-Clone 3.00 (amd64-unknown-freebsd10.0) Copyright (C) 1995-2010 Jörg Schilling\n"
"Using libscg version 'schily-0.9'\n"
"scsibus0:\n"
"        0,0,0     0) 'SEAGATE ' 'ST39236LW       ' '0004' Disk\n"
"        0,1,0     1) 'SEAGATE ' 'ST39173W        ' '5958' Disk\n"
"        0,2,0     2) *\n"
"        0,3,0     3) 'iomega  ' 'jaz 1GB         ' 'J.86' Removable Disk\n"
"        0,4,0     4) 'NEC     ' 'CD-ROM DRIVE:466' '1.26' Removable CD-ROM\n"
"        0,5,0     5) *\n"
"        0,6,0     6) *\n"
"        0,7,0     7) *\n"
"scsibus1:\n"
"        1,0,0   100) *\n"
"        1,1,0   101) *\n"
"        1,2,0   102) *\n"
"        1,3,0   103) *\n"
"        1,4,0   104) *\n"
"        1,5,0   105) 'YAMAHA  ' 'CRW4260         ' '1.0q' Removable CD-ROM\n"
"        1,6,0   106) 'ARTEC   ' 'AM12S           ' '1.06' Scanner\n"
"        1,7,0   107) *\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:639
msgid ""
"Locate the entry for the CD burner and use the three numbers separated by "
"commas as the value for `dev`.  In this case, the Yamaha burner device is "
"`1,5,0`, so the appropriate input to specify that device is `dev=1,5,0`.  "
"Refer to the manual page for `cdrecord` for other ways to specify this value "
"and for information on writing audio tracks and controlling the write speed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:641
msgid ""
"Alternately, run the following command to get the device address of the "
"burner:"
msgstr "您也可以使用以下命令获取刻录机的设备地址："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:646
#, no-wrap
msgid ""
"# camcontrol devlist\n"
"<MATSHITA CDRW/DVD UJDA740 1.00>   at scbus1 target 0 lun 0 (cd0,pass0)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:650
msgid ""
"Use the numeric values for `scbus`, `target`, and `lun`.  For this example, "
"`1,0,0` is the device name to use."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:652
#, no-wrap
msgid "Writing Data to an ISO File System"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:657
msgid ""
"In order to produce a data CD, the data files that are going to make up the "
"tracks on the CD must be prepared before they can be burned to the CD.  In "
"FreeBSD, package:sysutils/cdrtools[] installs `mkisofs`, which can be used "
"to produce an ISO 9660 file system that is an image of a directory tree "
"within a UNIX(R) file system.  The simplest usage is to specify the name of "
"the ISO file to create and the path to the files to place into the ISO 9660 "
"file system:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:661
#, no-wrap
msgid "# mkisofs -o imagefile.iso /path/to/tree\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:664
msgid ""
"This command maps the file names in the specified path to names that fit the "
"limitations of the standard ISO 9660 file system, and will exclude files "
"that do not meet the standard for ISO file systems."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:667
msgid ""
"A number of options are available to overcome the restrictions imposed by "
"the standard.  In particular, `-R` enables the Rock Ridge extensions common "
"to UNIX(R) systems and `-J` enables Joliet extensions used by Microsoft(R) "
"systems."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:670
msgid ""
"For CDs that are going to be used only on FreeBSD systems, `-U` can be used "
"to disable all filename restrictions.  When used with `-R`, it produces a "
"file system image that is identical to the specified FreeBSD tree, even if "
"it violates the ISO 9660 standard."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:678
msgid ""
"The last option of general use is `-b`.  This is used to specify the "
"location of a boot image for use in producing an \"El Torito\" bootable CD.  "
"This option takes an argument which is the path to a boot image from the top "
"of the tree being written to the CD.  By default, `mkisofs` creates an ISO "
"image in \"floppy disk emulation\" mode, and thus expects the boot image to "
"be exactly 1200, 1440 or 2880 KB in size.  Some boot loaders, like the one "
"used by the FreeBSD distribution media, do not use emulation mode.  In this "
"case, `-no-emul-boot` should be used.  So, if [.filename]#/tmp/myboot# holds "
"a bootable FreeBSD system with the boot image in [.filename]#/tmp/myboot/"
"boot/cdboot#, this command would produce [.filename]#/tmp/bootable.iso#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:682
#, no-wrap
msgid "# mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/myboot\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:685
msgid "The resulting ISO image can be mounted as a memory disk with:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:690
#, no-wrap
msgid ""
"# mdconfig -a -t vnode -f /tmp/bootable.iso -u 0\n"
"# mount -t cd9660 /dev/md0 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:693
msgid ""
"One can then verify that [.filename]#/mnt# and [.filename]#/tmp/myboot# are "
"identical."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:696
msgid ""
"There are many other options available for `mkisofs` to fine-tune its "
"behavior.  Refer to man:mkisofs[8] for details."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:701
msgid ""
"It is possible to copy a data CD to an image file that is functionally "
"equivalent to the image file created with `mkisofs`.  To do so, use [."
"filename]#dd# with the device name as the input file and the name of the ISO "
"to create as the output file:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:705
#, no-wrap
msgid "# dd if=/dev/cd0 of=file.iso bs=2048\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:708
msgid ""
"The resulting image file can be burned to CD as described in crossref:"
"disks[cdrecord, Burning a CD]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:711
#, no-wrap
msgid "Using Data CDs"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:714
msgid ""
"Once an ISO has been burned to a CD, it can be mounted by specifying the "
"file system type, the name of the device containing the CD, and an existing "
"mount point:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:718
#, no-wrap
msgid "# mount -t cd9660 /dev/cd0 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:721
msgid ""
"Since `mount` assumes that a file system is of type `ufs`, an `Incorrect "
"super block` error will occur if `-t cd9660` is not included when mounting a "
"data CD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:726
msgid ""
"While any data CD can be mounted this way, disks with certain ISO 9660 "
"extensions might behave oddly.  For example, Joliet disks store all "
"filenames in two-byte Unicode characters.  If some non-English characters "
"show up as question marks, specify the local charset with `-C`.  For more "
"information, refer to man:mount_cd9660[8]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:731
#, fuzzy
msgid ""
"In order to do this character conversion with the help of `-C`, the kernel "
"requires the [.filename]#cd9660_iconv.ko# module to be loaded.  This can be "
"done either by adding this line to [.filename]#loader.conf#:"
msgstr ""
"为了在以下的帮助下进行此字符转换<option>-C</option>，内核需要加载"
"<filename>cd9660_iconv.ko</filename>模块。这可以通过将此行添加到"
"<filename>loader.conf</filename>来实现："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:735
#, fuzzy, no-wrap
msgid "cd9660_iconv_load=\"YES\"\n"
msgstr "cd9660_iconv_load=\"YES\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:738
msgid ""
"and then rebooting the machine, or by directly loading the module with "
"`kldload`."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:743
msgid ""
"Occasionally, `Device not configured` will be displayed when trying to mount "
"a data CD.  This usually means that the CD drive has not detected a disk in "
"the tray, or that the drive is not visible on the bus.  It can take a couple "
"of seconds for a CD drive to detect media, so be patient."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:747
msgid ""
"Sometimes, a SCSICD drive may be missed because it did not have enough time "
"to answer the bus reset.  To resolve this, a custom kernel can be created "
"which increases the default SCSI delay.  Add the following option to the "
"custom kernel configuration file and rebuild the kernel using the "
"instructions in crossref:kernelconfig[kernelconfig-building,“Building and "
"Installing a Custom Kernel”]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:751
#, fuzzy, no-wrap
msgid "options SCSI_DELAY=15000\n"
msgstr "options SCSI_DELAY=15000\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:754
msgid ""
"This tells the SCSI bus to pause 15 seconds during boot, to give the CD "
"drive every possible chance to answer the bus reset."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:759
msgid ""
"It is possible to burn a file directly to CD, without creating an ISO 9660 "
"file system.  This is known as burning a raw data CD and some people do this "
"for backup purposes."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:763
#, fuzzy
msgid ""
"This type of disk can not be mounted as a normal data CD.  In order to "
"retrieve the data burned to such a CD, the data must be read from the raw "
"device node.  For example, this command will extract a compressed tar file "
"located on the second CD device into the current working directory:"
msgstr ""
"这种类型的磁盘不能作为普通数据<acronym>CD</acronym>安装。为了检索刻录到这种"
"<acronym>CD</acronym>的数据，必须从原始设备节点读取数据。例如，此命令将提取位"
"于第二个 <acronym>CD</acronym>设备上的压缩的 tar 文件到当前工作目录中:"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:767
#, no-wrap
msgid "# tar xzvf /dev/cd1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:770
msgid "In order to mount a data CD, the data must be written using `mkisofs`."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:773
#, no-wrap
msgid "Duplicating Audio CDs"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:776
msgid ""
"To duplicate an audio CD, extract the audio data from the CD to a series of "
"files, then write these files to a blank CD."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:780
msgid ""
"crossref:disks[using-cdrecord, Duplicating an Audio CD] describes how to "
"duplicate and burn an audio CD.  If the FreeBSD version is less than 10.0 "
"and the device is ATAPI, the `atapicam` module must be first loaded using "
"the instructions in crossref:disks[atapicam, Supported Devices]."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:783
#, no-wrap
msgid "Procedure: Duplicating an Audio CD"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:785
#, fuzzy
msgid ""
"The package:sysutils/cdrtools[] package or port installs `cdda2wav`. This "
"command can be used to extract all of the audio tracks, with each track "
"written to a separate WAV file in the current working directory:"
msgstr ""
"<command>cdda2wav</command> 包含在 <package>sysutils/cdrtools</package> 中，"
"可以用 package 或 port 安装。此程序可用于提取所有音轨，可将多个音轨分别提取到"
"当前目录下的 <acronym>WAV</acronym>文件中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:789
#, no-wrap
msgid "% cdda2wav -vall -B -Owav\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:793
#, fuzzy
msgid ""
"A device name does not need to be specified if there is only one CD device "
"on the system.  Refer to the `cdda2wav` manual page for instructions on how "
"to specify a device and to learn more about the other options available for "
"this command."
msgstr ""
"如果系统上只有一个<acronym>CD</acronym>设备，则不需要指定设备名称。请参阅 "
"<command>cdda2wav</command>手册页面，了解如何指定设备的说明，并了解此命令的其"
"他可用选项。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:794
msgid "Use `cdrecord` to write the [.filename]#.wav# files:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:798
#, no-wrap
msgid "% cdrecord -v dev=2,0 -dao -useinfo  *.wav\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:801
msgid ""
"Make sure that _2,0_ is set appropriately, as described in crossref:"
"disks[cdrecord, Burning a CD]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:803
#, no-wrap
msgid "Creating and Using DVD Media"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:807
msgid ""
"Compared to the CD, the DVD is the next generation of optical media storage "
"technology.  The DVD can hold more data than any CD and is the standard for "
"video publishing."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:809
msgid "Five physical recordable formats can be defined for a recordable DVD:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:811
msgid ""
"DVD-R: This was the first DVD recordable format available. The DVD-R "
"standard is defined by the http://www.dvdforum.org/forum.shtml[DVD Forum]. "
"This format is write once."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:812
msgid ""
"DVD-RW: This is the rewritable version of the DVD-R standard. A DVD-RW can "
"be rewritten about 1000 times."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:816
msgid ""
"DVD-RAM: This is a rewritable format which can be seen as a removable hard "
"drive. However, this media is not compatible with most DVD-ROM drives and "
"DVD-Video players as only a few DVD writers support the DVD-RAM format. "
"Refer to crossref:disks[creating-dvd-ram, Using a DVD-RAM] for more "
"information on DVD-RAM use."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:817
msgid ""
"DVD+RW: This is a rewritable format defined by the https://en.wikipedia.org/"
"wiki/DVD%2BRW_Alliance[DVD+RW Alliance]. A DVD+RW can be rewritten about "
"1000 times."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:818
msgid "DVD+R: This format is the write once variation of the DVD+RW format."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:820
msgid ""
"A single layer recordable DVD can hold up to 4,700,000,000 bytes which is "
"actually 4.38 GB or 4485 MB as 1 kilobyte is 1024 bytes."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:826
#, fuzzy
msgid ""
"A distinction must be made between the physical media and the application.  "
"For example, a DVD-Video is a specific file layout that can be written on "
"any recordable DVD physical media such as DVD-R, DVD+R, or DVD-RW.  Before "
"choosing the type of media, ensure that both the burner and the DVD-Video "
"player are compatible with the media under consideration."
msgstr ""
"必须区分物理介质和应用程序之间的区别。例如，DVD-Video是一种特定的文件布局，可"
"以写入任何可记录的<acronym>DVD</acronym>物理介质上，如DVD-R、DVD+R或"
"<acronym>DVD-RW</acronym>。在选择介质类型之前，请确保刻录机和DVD-Video播放器"
"都与所考虑的介质兼容。"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:828
#, no-wrap
msgid "Configuration"
msgstr "设置"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:832
msgid ""
"To perform DVD recording, use man:growisofs[1].  This command is part of the "
"package:sysutils/dvd+rw-tools[] utilities which support all DVD media types."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:837
msgid ""
"These tools use the SCSI subsystem to access the devices, therefore crossref:"
"disks[atapicam,ATAPI/CAM support] must be loaded or statically compiled into "
"the kernel.  This support is not needed if the burner uses the USB "
"interface.  Refer to crossref:disks[usb-disks, USB Storage Devices] for more "
"details on USB device configuration."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:839
msgid ""
"DMA access must also be enabled for ATAPI devices, by adding the following "
"line to [.filename]#/boot/loader.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:843
#: documentation/content/en/books/handbook/disks/_index.adoc:1076
#, fuzzy, no-wrap
msgid "hw.ata.atapi_dma=\"1\"\n"
msgstr "hw.ata.atapi_dma=\"1\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:846
msgid ""
"Before attempting to use dvd+rw-tools, consult the http://fy.chalmers.se/"
"~appro/linux/DVD+RW/hcn.html[Hardware Compatibility Notes]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:850
msgid ""
"For a graphical user interface, consider using package:sysutils/k3b[] which "
"provides a user friendly interface to man:growisofs[1] and many other "
"burning tools."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:852
#, no-wrap
msgid "Burning Data DVDs"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:856
msgid ""
"Since man:growisofs[1] is a front-end to crossref:disks[mkisofs,mkisofs], it "
"will invoke man:mkisofs[8] to create the file system layout and perform the "
"write on the DVD.  This means that an image of the data does not need to be "
"created before the burning process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:858
#, fuzzy
msgid ""
"To burn to a DVD+R or a DVD-R the data in [.filename]#/path/to/data#, use "
"the following command:"
msgstr ""
"使用以下命令将<filename>/path/to/data</filename>中的数据写入DVD+R 或 DVD-R："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:862
#, no-wrap
msgid "# growisofs -dvd-compat -Z /dev/cd0 -J -R /path/to/data\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:866
msgid ""
"In this example, `-J -R` is passed to man:mkisofs[8] to create an ISO 9660 "
"file system with Joliet and Rock Ridge extensions.  Refer to man:mkisofs[8] "
"for more details."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:871
msgid ""
"For the initial session recording, `-Z` is used for both single and multiple "
"sessions.  Replace _/dev/cd0_, with the name of the DVD device.  Using `-dvd-"
"compat` indicates that the disk will be closed and that the recording will "
"be unappendable.  This should also provide better media compatibility with "
"DVD-ROM drives."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:873
msgid "To burn a pre-mastered image, such as _imagefile.iso_, use:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:877
#, no-wrap
msgid "# growisofs -dvd-compat -Z /dev/cd0=imagefile.iso\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:881
msgid ""
"The write speed should be detected and automatically set according to the "
"media and the drive being used.  To force the write speed, use `-speed=`. "
"Refer to man:growisofs[1] for example usage."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:888
msgid ""
"In order to support working files larger than 4.38GB, an UDF/ISO-9660 hybrid "
"file system must be created by passing `-udf -iso-level 3` to man:mkisofs[8] "
"and all related programs, such as man:growisofs[1].  This is required only "
"when creating an ISO image file or when writing files directly to a disk.  "
"Since a disk created this way must be mounted as an UDF file system with man:"
"mount_udf[8], it will be usable only on an UDF aware operating system.  "
"Otherwise it will look as if it contains corrupted files."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:890
msgid "To create this type of ISO file:"
msgstr "创建 UDF 格式的 ISO 文件："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:894
#, no-wrap
msgid "% mkisofs -R -J -udf -iso-level 3 -o imagefile.iso /path/to/data\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:897
msgid "To burn files directly to a disk:"
msgstr "直接将文件写入光盘："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:901
#, no-wrap
msgid "# growisofs -dvd-compat -udf -iso-level 3 -Z /dev/cd0 -J -R /path/to/data\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:904
msgid ""
"When an ISO image already contains large files, no additional options are "
"required for man:growisofs[1] to burn that image on a disk."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:907
msgid ""
"Be sure to use an up-to-date version of package:sysutils/cdrtools[], which "
"contains man:mkisofs[8], as an older version may not contain large files "
"support.  If the latest version does not work, install package:sysutils/"
"cdrtools-devel[] and read its man:mkisofs[8]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:909
#, no-wrap
msgid "Burning a DVD-Video"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:913
#, fuzzy
msgid ""
"A DVD-Video is a specific file layout based on the ISO 9660 and micro-UDF (M-"
"UDF) specifications.  Since DVD-Video presents a specific data structure "
"hierarchy, a particular program such as package:multimedia/dvdauthor[] is "
"needed to author the DVD."
msgstr ""
"DVD 视频是基于 ISO 9660 和微型 UDF （M-UDF） 规范的特定文件布局。由于 DVD-"
"Video 具有特定的数据结构层次结构，因此需要特定的程序（如<package>multimedia/"
"dvdauthor</package>）来向<acronym>DVD</acronym>写入数据。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:916
#, fuzzy
msgid ""
"If an image of the DVD-Video file system already exists, it can be burned in "
"the same way as any other image.  If `dvdauthor` was used to make the DVD "
"and the result is in [.filename]#/path/to/video#, the following command "
"should be used to burn the DVD-Video:"
msgstr ""
"如果DVD-视频文件系统的映像已经存在，则可以像其他映像一样，以同样的方式刻录。"
"如果使用<command>dvdauthor</command>制作<acronym>DVD</acronym>，结果是在"
"<filename>/path/to/video</filename>中，则应使用以下命令来刻录DVD-Video："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:920
#, no-wrap
msgid "# growisofs -Z /dev/cd0 -dvd-video /path/to/video\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:924
msgid ""
"`-dvd-video` is passed to man:mkisofs[8] to instruct it to create a DVD-"
"Video file system layout.  This option implies the `-dvd-compat` man:"
"growisofs[1] option."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:925
#, no-wrap
msgid "Using a DVD+RW"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:930
msgid ""
"Unlike CD-RW, a virgin DVD+RW needs to be formatted before first use.  It is "
"_recommended_ to let man:growisofs[1] take care of this automatically "
"whenever appropriate.  However, it is possible to use `dvd+rw-format` to "
"format the DVD+RW:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:934
#: documentation/content/en/books/handbook/disks/_index.adoc:1024
#, no-wrap
msgid "# dvd+rw-format /dev/cd0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:938
msgid ""
"Only perform this operation once and keep in mind that only virgin DVD+RW "
"medias need to be formatted.  Once formatted, the DVD+RW can be burned as "
"usual."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:941
#, fuzzy
msgid ""
"To burn a totally new file system and not just append some data onto a DVD"
"+RW, the media does not need to be blanked first.  Instead, write over the "
"previous recording like this:"
msgstr ""
"要刻录一个全新的文件系统，而不仅仅是将一些数据追加到<acronym>DVD+RW</acronym>"
"上，DVD 不需要清空。相反，请按上述记录进行编写："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:945
#, no-wrap
msgid "# growisofs -Z /dev/cd0 -J -R /path/to/newdata\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:950
msgid ""
"The DVD+RW format supports appending data to a previous recording.  This "
"operation consists of merging a new session to the existing one as it is not "
"considered to be multi-session writing.  man:growisofs[1] will _grow_ the "
"ISO 9660 file system present on the media."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:952
msgid "For example, to append data to a DVD+RW, use the following:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:956
#: documentation/content/en/books/handbook/disks/_index.adoc:1044
#, no-wrap
msgid "# growisofs -M /dev/cd0 -J -R /path/to/nextdata\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:959
msgid ""
"The same man:mkisofs[8] options used to burn the initial session should be "
"used during next writes."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:964
msgid ""
"Use `-dvd-compat` for better media compatibility with DVD-ROM drives.  When "
"using DVD+RW, this option will not prevent the addition of data."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:967
msgid "To blank the media, use:"
msgstr "使用以下命令清空数据："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:971
#, no-wrap
msgid "# growisofs -Z /dev/cd0=/dev/zero\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:973
#, no-wrap
msgid "Using a DVD-RW"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:977
msgid ""
"A DVD-RW accepts two disc formats: incremental sequential and restricted "
"overwrite.  By default, DVD-RW discs are in sequential format."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:980
msgid ""
"A virgin DVD-RW can be directly written without being formatted.  However, a "
"non-virgin DVD-RW in sequential format needs to be blanked before writing a "
"new initial session."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:982
msgid "To blank a DVD-RW in sequential mode:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:986
#: documentation/content/en/books/handbook/disks/_index.adoc:1031
#, no-wrap
msgid "# dvd+rw-format -blank=full /dev/cd0\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:993
msgid ""
"A full blanking using `-blank=full` will take about one hour on a 1x media.  "
"A fast blanking can be performed using `-blank`, if the DVD-RW will be "
"recorded in Disk-At-Once (DAO) mode.  To burn the DVD-RW in DAO mode, use "
"the command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:997
#, no-wrap
msgid "# growisofs -use-the-force-luke=dao -Z /dev/cd0=imagefile.iso\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1000
msgid ""
"Since man:growisofs[1] automatically attempts to detect fast blanked media "
"and engage DAO write, `-use-the-force-luke=dao` should not be required."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1002
msgid ""
"One should instead use restricted overwrite mode with any DVD-RW as this "
"format is more flexible than the default of incremental sequential."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1005
msgid ""
"To write data on a sequential DVD-RW, use the same instructions as for the "
"other DVD formats:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1009
#, no-wrap
msgid "# growisofs -Z /dev/cd0 -J -R /path/to/data\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1013
msgid ""
"To append some data to a previous recording, use `-M` with man:"
"growisofs[1].  However, if data is appended on a DVD-RW in incremental "
"sequential mode, a new session will be created on the disc and the result "
"will be a multi-session disc."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1018
msgid ""
"A DVD-RW in restricted overwrite format does not need to be blanked before a "
"new initial session.  Instead, overwrite the disc with `-Z`.  It is also "
"possible to grow an existing ISO 9660 file system written on the disc with `-"
"M`.  The result will be a one-session DVD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1020
msgid ""
"To put a DVD-RW in restricted overwrite format, the following command must "
"be used:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1027
msgid "To change back to sequential format, use:"
msgstr "要更改回顺序格式，请使用："

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1033
#, no-wrap
msgid "Multi-Session"
msgstr "多阶段刻录（Multi-Session）"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1038
msgid ""
"Few DVD-ROM drives support multi-session DVDs and most of the time only read "
"the first session.  DVD+R, DVD-R and DVD-RW in sequential format can accept "
"multiple sessions.  The notion of multiple sessions does not exist for the "
"DVD+RW and the DVD-RW restricted overwrite formats."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1040
msgid ""
"Using the following command after an initial non-closed session on a DVD+R, "
"DVD-R, or DVD-RW in sequential format, will add a new session to the disc:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1049
#, fuzzy
msgid ""
"Using this command with a DVD+RW or a DVD-RW in restricted overwrite mode "
"will append data while merging the new session to the existing one.  The "
"result will be a single-session disc.  Use this method to add data after an "
"initial write on these types of media."
msgstr ""
"在限制覆盖模式下，使用此命令与<acronym>DVD+RW</acronym>或<acronym>DVD-RW</"
"acronym>，将在将新会话合并到现有会话的同时，附加数据。其结果将是一个单一会话"
"光盘。在这些类型的介质上初始写入后使用此方法添加数据。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1054
#, fuzzy
#| msgid ""
#| "Since some space on the media is used between each session to mark the "
#| "end and start of sessions, one should add sessions with a large amount of "
#| "data to optimize media space. The number of sessions is limited to 154 "
#| "for a DVD+R, about 2000 for a DVD-R, and 127 for a DVD+R Double Layer."
msgid ""
"Since some space on the media is used between each session to mark the end "
"and start of sessions, one should add sessions with a large amount of data "
"to optimize media space.  The number of sessions is limited to 154 for a DVD"
"+R, about 2000 for a DVD-R, and 127 for a DVD+R Double Layer."
msgstr ""
"由于每个会话之间都会在介质上留出一些空间来标记会话的开头和结尾，所以应该增加"
"数据量大的会话，以优化介质空间。对于DVD+R来说，会话的数量限制在154个，DVD-R大"
"约2000个，DVD+R双层为127个。"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1056
#, no-wrap
msgid "For More Information"
msgstr "取得更多资讯"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1059
msgid ""
"To obtain more information about a DVD, use `dvd+rw-mediainfo _/dev/cd0_` "
"while the disc in the specified drive."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1061
msgid ""
"More information about dvd+rw-tools can be found in man:growisofs[1], on the "
"http://fy.chalmers.se/~appro/linux/DVD+RW/[dvd+rw-tools web site], and in "
"the http://lists.debian.org/cdwrite/[cdwrite mailing list] archives."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1065
msgid ""
"When creating a problem report related to the use of dvd+rw-tools, always "
"include the output of `dvd+rw-mediainfo`."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1068
#, no-wrap
msgid "Using a DVD-RAM"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1072
#, fuzzy
msgid ""
"DVD-RAM writers can use either a SCSI or ATAPI interface.  For ATAPI "
"devices, DMA access has to be enabled by adding the following line to [."
"filename]#/boot/loader.conf#:"
msgstr ""
"您也可以将此行添加到<filename>/boot/loader.conf</filename>让系统在启动时加载 "
"ATAPI 驱动："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1081
#, fuzzy
msgid ""
"A DVD-RAM can be seen as a removable hard drive.  Like any other hard drive, "
"the DVD-RAM must be formatted before it can be used.  In this example, the "
"whole disk space will be formatted with a standard UFS2 file system:"
msgstr ""
"<acronym>DVD-RAM</acronym>可被视为可移动硬盘。与任何其他硬盘驱动器一样，"
"<acronym>DVD-RAM</acronym>必须先格式化，然后才能使用。在此示例中，整个磁盘空"
"间将采用标准的 UFS2 文件系统进行格式化："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1087
#, no-wrap
msgid ""
"# dd if=/dev/zero of=/dev/acd0 bs=2k count=1\n"
"# bsdlabel -Bw acd0\n"
"# newfs /dev/acd0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1090
msgid ""
"The DVD device, [.filename]#acd0#, must be changed according to the "
"configuration."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1092
msgid ""
"Once the DVD-RAM has been formatted, it can be mounted as a normal hard "
"drive:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1096
#, no-wrap
msgid "# mount /dev/acd0 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1099
msgid "Once mounted, the DVD-RAM will be both readable and writeable."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:1101
#, no-wrap
msgid "Creating and Using Floppy Disks"
msgstr "建立与使用软盘"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1104
msgid "This section explains how to format a 3.5 inch floppy disk in FreeBSD."
msgstr "本章介绍如何在 FreeBSD 中格式化 3.5 寸软盘。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1108
#, no-wrap
msgid "*Procedure: Steps to Format a Floppy*\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1113
msgid ""
"A floppy disk needs to be low-level formatted before it can be used.  This "
"is usually done by the vendor, but formatting is a good way to check media "
"integrity.  To low-level format the floppy disk on FreeBSD, use man:"
"fdformat[1].  When using this utility, make note of any error messages, as "
"these can help determine if the disk is good or bad."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1115
msgid ""
"To format the floppy, insert a new 3.5 inch floppy disk into the first "
"floppy drive and issue:"
msgstr ""
"若需格式化软盘，产褥一张新的 3.5 寸软盘到第一个软盘驱动器并执行以下命令："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1119
#, no-wrap
msgid "# /usr/sbin/fdformat -f 1440 /dev/fd0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1122
#, fuzzy
msgid ""
"After low-level formatting the disk, create a disk label as it is needed by "
"the system to determine the size of the disk and its geometry. The supported "
"geometry values are listed in [.filename]#/etc/disktab#."
msgstr ""
"在对磁盘进行低级格式化之后，请创建系统所需的磁盘标签，以确定磁盘的大小及其几"
"何数据（geometry）。受支持的几何数据在<filename>/etc/disktab</filename>中列"
"出。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1124
msgid "To write the disk label, use man:bsdlabel[8]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1128
#, no-wrap
msgid "# /sbin/bsdlabel -B -w /dev/fd0 fd1440\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1131
msgid ""
"The floppy is now ready to be high-level formatted with a file system. The "
"floppy's file system can be either UFS or FAT, where FAT is generally a "
"better choice for floppies."
msgstr ""
"软盘已经可以进行高级格式化了。软盘的文件系统可以选择 UFS 或 FAT，推荐选择 "
"FAT。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1133
msgid "To format the floppy with FAT, issue:"
msgstr "使用以下命令将软盘格式化成FAT格式："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1137
#, no-wrap
msgid "# /sbin/newfs_msdos /dev/fd0\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1143
msgid ""
"The disk is now ready for use.  To use the floppy, mount it with man:"
"mount_msdosfs[8].  One can also install and use package:emulators/mtools[] "
"from the Ports Collection."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:1145
#, no-wrap
msgid "Backup Basics"
msgstr "基础备份知识"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1148
msgid ""
"Implementing a backup plan is essential in order to have the ability to "
"recover from disk failure, accidental file deletion, random file corruption, "
"or complete machine destruction, including destruction of on-site backups."
msgstr ""
"实施备份计划对于从磁盘故障、意外文件删除、随机文件损坏或完全销毁计算机（包括"
"销毁现场备份）中恢复至关重要。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1151
#, fuzzy
#| msgid ""
#| "The backup type and schedule will vary, depending upon the importance of "
#| "the data, the granularity needed for file restores, and the amount of "
#| "acceptable downtime. Some possible backup techniques include:"
msgid ""
"The backup type and schedule will vary, depending upon the importance of the "
"data, the granularity needed for file restores, and the amount of acceptable "
"downtime.  Some possible backup techniques include:"
msgstr ""
"备份类型和计划会有所不同，具体取决于数据的重要性、文件还原所需的粒度以及可接"
"受的停机时间。一些可能的备份技术包括："

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1153
msgid ""
"Archives of the whole system, backed up onto permanent, off-site media. This "
"provides protection against all of the problems listed above, but is slow "
"and inconvenient to restore from, especially for non-privileged users."
msgstr ""
"整个系统的文件，备份到永久的，场外媒体。这提供了针对上述所有问题的保护，但恢"
"复速度很慢，并且不方便，尤其是对于非特权用户。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1154
msgid ""
"File system snapshots, which are useful for restoring deleted files or "
"previous versions of files."
msgstr "文件系统快照，可用于还原已删除的文件或以前版本的文件。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1155
#, fuzzy
msgid ""
"Copies of whole file systems or disks which are synchronized with another "
"system on the network using a scheduled package:net/rsync[]."
msgstr ""
"定期使用<package>net/rsync</package>与网络上的另一个系统同步的整个文件系统或"
"磁盘的副本。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1156
msgid ""
"Hardware or software RAID, which minimizes or avoids downtime when a disk "
"fails."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1160
#, fuzzy
#| msgid ""
#| "Typically, a mix of backup techniques is used. For example, one could "
#| "create a schedule to automate a weekly, full system backup that is stored "
#| "off-site and to supplement this backup with hourly ZFS snapshots. In "
#| "addition, one could make a manual backup of individual directories or "
#| "files before making file edits or deletions."
msgid ""
"Typically, a mix of backup techniques is used.  For example, one could "
"create a schedule to automate a weekly, full system backup that is stored "
"off-site and to supplement this backup with hourly ZFS snapshots.  In "
"addition, one could make a manual backup of individual directories or files "
"before making file edits or deletions."
msgstr ""
"通常，使用混合备份技术。例如，可以创建一个计划来自动执行每周一次的、在异地存"
"储的完整系统备份，并为此备份补充每小时一次的 ZFS 快照。此外，在进行文件编辑或"
"删除之前，可以手动备份各个目录或文件。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1162
msgid ""
"This section describes some of the utilities which can be used to create and "
"manage backups on a FreeBSD system."
msgstr "本节介绍一些可用于在 FreeBSD 系统上创建和管理备份的实用程序。"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1163
#, no-wrap
msgid "File System Backups"
msgstr "文件系统备份"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1169
msgid ""
"The traditional UNIX(R) programs for backing up a file system are man:"
"dump[8], which creates the backup, and man:restore[8], which restores the "
"backup.  These utilities work at the disk block level, below the "
"abstractions of the files, links, and directories that are created by file "
"systems.  Unlike other backup software, `dump` backs up an entire file "
"system and is unable to backup only part of a file system or a directory "
"tree that spans multiple file systems.  Instead of writing files and "
"directories, `dump` writes the raw data blocks that comprise files and "
"directories."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1173
#, fuzzy
msgid ""
"If `dump` is used on the root directory, it will not back up [.filename]#/"
"home#, [.filename]#/usr#, or many other directories since these are "
"typically mount points for other file systems or symbolic links into those "
"file systems."
msgstr ""
"如果在根目录上使用<command>dump</command>，它将不会备份<filename>/home</"
"filename> <filename>、/usr</filename>或许多其他目录，因为这些目录通常是其他文"
"件系统的装载点或到这些文件系统的符号链接。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1177
msgid ""
"When used to restore data, `restore` stores temporary files in [.filename]#/"
"tmp/# by default.  When using a recovery disk with a small [.filename]#/"
"tmp#, set `TMPDIR` to a directory with more free space for the restore to "
"succeed."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1181
msgid ""
"When using `dump`, be aware that some quirks remain from its early days in "
"Version 6 of AT&T UNIX(R),circa 1975.  The default parameters assume a "
"backup to a 9-track tape, rather than to another type of media or to the "
"high-density tapes available today.  These defaults must be overridden on "
"the command line."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1184
msgid ""
"It is possible to backup a file system across the network to another system "
"or a tape drive attached to another computer.  While the man:rdump[8] and "
"man:rrestore[8] utilities can be used for this purpose, they are not "
"considered to be secure."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1187
msgid ""
"Instead, one can use `dump` and `restore` more securely over an SSH "
"connection.  This example creates a full, compressed backup of [.filename]#/"
"usr# and sends the backup file to the specified host over an SSH connection."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1188
#, no-wrap
msgid "Using `dump` over ssh"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1195
#, no-wrap
msgid ""
"# /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \\\n"
"          targetuser@targetmachine.example.com dd of=/mybigfiles/dump-usr-l0.gz\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1199
msgid ""
"This example sets `RSH` in order to write the backup to a tape drive on a "
"remote system over an SSH connection:"
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1200
#, no-wrap
msgid "Using `dump` over ssh with `RSH` Set"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1206
#, no-wrap
msgid "# env RSH=/usr/bin/ssh /sbin/dump -0uan -f targetuser@targetmachine.example.com:/dev/sa0 /usr\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1212
msgid ""
"Systems using the crossref:zfs[,Z file system (ZFS)] can make use of man:"
"zfs[8] for creating snapshots, as well as crossref:zfs[zfs-zfs-send,sending "
"and receiving] them to/from remote systems."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1214
#, no-wrap
msgid "Directory Backups"
msgstr "备份目录"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1217
msgid ""
"Several built-in utilities are available for backing up and restoring "
"specified files and directories as needed."
msgstr "有很多备份软件可用于备份文件和目录。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1221
msgid ""
"A good choice for making a backup of all of the files in a directory is man:"
"tar[1].  This utility dates back to Version 6 of AT&T UNIX(R) and by default "
"assumes a recursive backup to a local tape device.  Switches can be used to "
"instead specify the name of a backup file."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1224
#, fuzzy
msgid ""
"This example creates a compressed backup of the current directory and saves "
"it to [.filename]#/tmp/mybackup.tgz#.  When creating a backup file, make "
"sure that the backup is not saved to the same directory that is being backed "
"up."
msgstr ""
"这个例子会建立目前目录的压缩备份并储存至<filename>/tmp/mybackup.tgz</"
"filename>，在建立备份文件时，要确认备份文件不要储存到与目前备份目录相同的目"
"录。"

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1225
#, no-wrap
msgid "Backing Up the Current Directory with `tar`"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1231
#, no-wrap
msgid "# tar czvf /tmp/mybackup.tgz .\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1237
#, fuzzy
msgid ""
"To restore the entire backup, `cd` into the directory to restore into and "
"specify the name of the backup.  Note that this will overwrite any newer "
"versions of files in the restore directory.  When in doubt, restore to a "
"temporary directory or specify the name of the file within the backup to "
"restore."
msgstr ""
"要还原整个备份，先<command>cd</command>进入要放置还原档的目录并指定备份的名"
"称。注意，这个动作会复写任何在该还原目录中任何较新版的文件，当不确定时，可先"
"还原到一个暂时的目录或指定备份档中的文件做还原。"

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1238
#, no-wrap
msgid "Restoring Up the Current Directory with `tar`"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1244
#, no-wrap
msgid "# tar xzvf /tmp/mybackup.tgz\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1249
msgid ""
"There are dozens of available switches which are described in man:tar[1].  "
"This utility also supports the use of exclude patterns to specify which "
"files should not be included when backing up the specified directory or "
"restoring files from a backup."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1252
msgid ""
"To create a backup using a specified list of files and directories, man:"
"cpio[1] is a good choice.  Unlike `tar`, `cpio` does not know how to walk "
"the directory tree and it must be provided the list of files to backup."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1255
msgid ""
"For example, a list of files can be created using `ls` or `find`.  This "
"example creates a recursive listing of the current directory which is then "
"piped to `cpio` in order to create an output backup file named [.filename]#/"
"tmp/mybackup.cpio#."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1256
#, no-wrap
msgid "Using `ls` and `cpio` to Make a Recursive Backup of the Current Directory"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1262
#, no-wrap
msgid "# ls -R | cpio -ovF /tmp/mybackup.cpio\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1268
msgid ""
"A backup utility which tries to bridge the features provided by `tar` and "
"`cpio` is man:pax[1].  Over the years, the various versions of `tar` and "
"`cpio` became slightly incompatible.  POSIX(R) created `pax` which attempts "
"to read and write many of the various `cpio` and `tar` formats, plus new "
"formats of its own."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1270
msgid "The `pax` equivalent to the previous examples would be:"
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1271
#, no-wrap
msgid "Backing Up the Current Directory with `pax`"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1277
#, no-wrap
msgid "# pax -wf /tmp/mybackup.pax .\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1281
#, no-wrap
msgid "Using Data Tapes for Backups"
msgstr "使用磁带备份数据"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1286
msgid ""
"While tape technology has continued to evolve, modern backup systems tend to "
"combine off-site backups with local removable media.  FreeBSD supports any "
"tape drive that uses SCSI, such as LTO or DAT.  There is limited support for "
"SATA and USB tape drives."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1290
msgid ""
"For SCSI tape devices, FreeBSD uses the man:sa[4] driver and the [."
"filename]#/dev/sa0#, [.filename]#/dev/nsa0#, and [.filename]#/dev/esa0# "
"devices.  The physical device name is [.filename]#/dev/sa0#. When [."
"filename]#/dev/nsa0# is used, the backup application will not rewind the "
"tape after writing a file, which allows writing more than one file to a "
"tape.  Using [.filename]#/dev/esa0# ejects the tape after the device is "
"closed."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1293
#, fuzzy
msgid ""
"In FreeBSD, `mt` is used to control operations of the tape drive, such as "
"seeking through files on a tape or writing tape control marks to the tape.  "
"For example, the first three files on a tape can be preserved by skipping "
"past them before writing a new file:"
msgstr ""
"在FreeBSD中会使用<command>mt</command>来做磁带机的控制操作，例如在磁带中搜寻"
"文件或写入磁带控制记号到磁带。例如，要保留磁带上的前三个文件，可以在写入新文"
"件前跳过这些文件："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1297
#, no-wrap
msgid "# mt -f /dev/nsa0 fsf 3\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1300
msgid "This utility supports many operations. Refer to man:mt[1] for details."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1302
msgid ""
"To write a single file to tape using `tar`, specify the name of the tape "
"device and the file to backup:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1306
#, no-wrap
msgid "# tar cvf /dev/sa0 file\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1309
msgid ""
"To recover files from a `tar` archive on tape into the current directory:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1313
#, no-wrap
msgid "# tar xvf /dev/sa0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1317
msgid ""
"To backup a UFS file system, use `dump`.  This examples backs up [."
"filename]#/usr# without rewinding the tape when finished:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1321
#, no-wrap
msgid "# dump -0aL -b64 -f /dev/nsa0 /usr\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1324
msgid ""
"To interactively restore files from a `dump` file on tape into the current "
"directory:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1328
#, no-wrap
msgid "# restore -i -f /dev/nsa0\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1331
#, no-wrap
msgid "Third-Party Backup Utilities"
msgstr "第三方备份软件"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1335
#, fuzzy
#| msgid ""
#| "The FreeBSD Ports Collection provides many third-party utilities which "
#| "can be used to schedule the creation of backups, simplify tape backup, "
#| "and make backups easier and more convenient. Many of these applications "
#| "are client/server based and can be used to automate the backups of a "
#| "single system or all of the computers in a network."
msgid ""
"The FreeBSD Ports Collection provides many third-party utilities which can "
"be used to schedule the creation of backups, simplify tape backup, and make "
"backups easier and more convenient.  Many of these applications are client/"
"server based and can be used to automate the backups of a single system or "
"all of the computers in a network."
msgstr ""
"FreeBSD Port套件集提供了许多第三方工具可用于排程建立备份，简化磁带备份并让备"
"份更简单方便。许多这类的应用程序是以客户端/服务器为基础，可用来自动化单一系统"
"或网络上所有电脑的备份。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1337
msgid "Popular utilities include:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1339
msgid "Amanda (package:misc/amanda-server[] and package:misc/amanda-client[]),"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1340
msgid ""
"Bacula (package:sysutils/bacula13-server[] and package:sysutils/bacula13-"
"client[]),"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1341
msgid ""
"Bareos (package:sysutils/bareos-server[] and package:sysutils/bareos-"
"client[]),"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1342
msgid "package:net/rsync[],"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1343
msgid "package:sysutils/duply[], and"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1344
msgid "package:sysutils/duplicity[]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1345
#, no-wrap
msgid "Emergency Recovery"
msgstr "紧急恢复"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1348
msgid ""
"In addition to regular backups, it is recommended to perform the following "
"steps as part of an emergency preparedness plan."
msgstr "除了正常的备份外，建议将下以步骤做为紧急准备计划的一部份。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1350
msgid "Create a print copy of the output of the following commands:"
msgstr "替以下指令的输出建立一份可打印的复本："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1352
msgid "`gpart show`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1353
msgid "`more /etc/fstab`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1354
msgid "`pkg prime-list`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1355
msgid "`dmesg`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1359
#, fuzzy
msgid ""
"Store this printout and a copy of the installation media in a secure "
"location.  Should an emergency restore be needed, boot into the installation "
"media and select `Live CD` to access a rescue shell.  This rescue mode can "
"be used to view the current state of the system, and if needed, to reformat "
"disks and restore data from backups."
msgstr ""
"在安全的地方保存这份打印结果与安装媒体的复本，在紧急还原时可能会需要，接着开"
"机进入安装媒体并选择<literal>Live CD </literal>以存取救援Shell（Rescue "
"shell），这个救援模式可以用来检视目前系统的状态，若有需要，可重新格式化磁盘然"
"后自备份还原数据。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1364
#, fuzzy
#| msgid ""
#| "Next, test the rescue shell and the backups. Make notes of the procedure. "
#| "Store these notes with the media, the printouts, and the backups. These "
#| "notes may prevent the inadvertent destruction of the backups while under "
#| "the stress of performing an emergency recovery."
msgid ""
"Next, test the rescue shell and the backups.  Make notes of the procedure.  "
"Store these notes with the media, the printouts, and the backups.  These "
"notes may prevent the inadvertent destruction of the backups while under the "
"stress of performing an emergency recovery."
msgstr ""
"然后，测试救援Shell下的备份。记录下整个程序，将这份记录随媒体、列印结果、备份"
"档一并保存，这份记录可以避免在紧张压力下做紧急还原时因不慎造成备份的毁坏。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1366
msgid ""
"For an added measure of security, store the latest backup at a remote "
"location which is physically separated from the computers and disk drives by "
"a significant distance."
msgstr ""
"要再安全性一点，则可将最新的备份储存在与实体电脑与磁碟机有一段明显距离的远端"
"位置。"

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:1368
#, no-wrap
msgid "Memory Disks"
msgstr "以内存为介质的文件系统"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1372
msgid ""
"In addition to physical disks, FreeBSD also supports the creation and use of "
"memory disks.  One possible use for a memory disk is to access the contents "
"of an ISO file system without the overhead of first burning it to a CD or "
"DVD, then mounting the CD/DVD media."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1376
msgid ""
"In FreeBSD, the man:md[4] driver is used to provide support for memory "
"disks.  The [.filename]#GENERIC# kernel includes this driver.  When using a "
"custom kernel configuration file, ensure it includes this line:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1380
#, fuzzy, no-wrap
msgid "device md\n"
msgstr "device md\n"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1383
#, no-wrap
msgid "Attaching and Detaching Existing Images"
msgstr "连接与解除连接既有的映象档"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1389
msgid ""
"To mount an existing file system image, use `mdconfig` to specify the name "
"of the ISO file and a free unit number.  Then, refer to that unit number to "
"mount it on an existing mount point.  Once mounted, the files in the ISO "
"will appear in the mount point.  This example attaches _diskimage.iso_ to "
"the memory device [.filename]#/dev/md0# then mounts that memory device on [."
"filename]#/mnt#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1394
#, no-wrap
msgid ""
"# mdconfig -f diskimage.iso -u 0\n"
"# mount -t cd9660 /dev/md0 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1399
msgid ""
"Notice that `-t cd9660` was used to mount an ISO format.  If a unit number "
"is not specified with `-u`, `mdconfig` will automatically allocate an unused "
"memory device and output the name of the allocated unit, such as [."
"filename]#md4#.  Refer to man:mdconfig[8] for more details about this "
"command and its options."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1403
#, fuzzy
msgid ""
"When a memory disk is no longer in use, its resources should be released "
"back to the system.  First, unmount the file system, then use `mdconfig` to "
"detach the disk from the system and release its resources.  To continue this "
"example:"
msgstr ""
"若内存盘不再使用，这些内存应还给系统。首先卸载文件系统，然后使用"
"<command>mdconfig</command>从系统中移除磁盘并释放资源："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1408
#, no-wrap
msgid ""
"# umount /mnt\n"
"# mdconfig -d -u 0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1411
msgid ""
"To determine if any memory disks are still attached to the system, type "
"`mdconfig -l`."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1413
#, no-wrap
msgid "Creating a File- or Memory-Backed Memory Disk"
msgstr "以内存为介质的文件系统"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1418
#, fuzzy
msgid ""
"FreeBSD also supports memory disks where the storage to use is allocated "
"from either a hard disk or an area of memory.  The first method is commonly "
"referred to as a file-backed file system and the second method as a memory-"
"backed file system.  Both types can be created using `mdconfig`."
msgstr ""
"FreeBSD 还支持从硬盘或内存区域分配要使用的存储的内存磁盘。第一种方法通常称为"
"文件支持的文件系统，第二种方法称为内存支持的文件系统。这两种类都可以使用"
"<command>mdconfig</command>创建。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1423
msgid ""
"To create a new memory-backed file system, specify a type of `swap` and the "
"size of the memory disk to create.  Then, format the memory disk with a file "
"system and mount as usual.  This example creates a 5M memory disk on unit "
"`1`.  That memory disk is then formatted with the UFS file system before it "
"is mounted:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1437
#, no-wrap
msgid ""
"# mdconfig -a -t swap -s 5m -u 1\n"
"# newfs -U md1\n"
"/dev/md1: 5.0MB (10240 sectors) block size 16384, fragment size 2048\n"
"        using 4 cylinder groups of 1.27MB, 81 blks, 192 inodes.\n"
"        with soft updates\n"
"super-block backups (for fsck -b #) at:\n"
" 160, 2752, 5344, 7936\n"
"# mount /dev/md1 /mnt\n"
"# df /mnt\n"
"Filesystem 1K-blocks Used Avail Capacity  Mounted on\n"
"/dev/md1        4718    4  4338     0%    /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1441
#, fuzzy
msgid ""
"To create a new file-backed memory disk, first allocate an area of disk to "
"use.  This example creates an empty 5MB file named [.filename]#newimage#:"
msgstr ""
"要创建新的文件支持的内存磁盘，请先分配要使用的磁盘区域。本例创建一个大小为 "
"5MB，名为<filename>newimage</filename>基于文件的内存盘："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1447
#, no-wrap
msgid ""
"# dd if=/dev/zero of=newimage bs=1k count=5k\n"
"5120+0 records in\n"
"5120+0 records out\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1450
msgid ""
"Next, attach that file to a memory disk, label the memory disk and format it "
"with the UFS file system, mount the memory disk, and verify the size of the "
"file-backed disk:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1464
#, no-wrap
msgid ""
"# mdconfig -f newimage -u 0\n"
"# bsdlabel -w md0 auto\n"
"# newfs -U md0a\n"
"/dev/md0a: 5.0MB (10224 sectors) block size 16384, fragment size 2048\n"
"        using 4 cylinder groups of 1.25MB, 80 blks, 192 inodes.\n"
"super-block backups (for fsck -b #) at:\n"
" 160, 2720, 5280, 7840\n"
"# mount /dev/md0a /mnt\n"
"# df /mnt\n"
"Filesystem 1K-blocks Used Avail Capacity  Mounted on\n"
"/dev/md0a       4710    4  4330     0%    /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1469
msgid ""
"It takes several commands to create a file- or memory-backed file system "
"using `mdconfig`.  FreeBSD also comes with `mdmfs` which automatically "
"configures a memory disk, formats it with the UFS file system, and mounts "
"it.  For example, after creating _newimage_ with `dd`, this one command is "
"equivalent to running the `bsdlabel`, `newfs`, and `mount` commands shown "
"above:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1473
#, no-wrap
msgid "# mdmfs -F newimage -s 5m md0 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1476
#, fuzzy
msgid ""
"To instead create a new memory-based memory disk with `mdmfs`, use this one "
"command:"
msgstr ""
"要改用<command>mdmfs</command>创建新的基于内存的内存磁盘，请使用此命令："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1480
#, no-wrap
msgid "# mdmfs -s 5m md1 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1484
msgid ""
"If the unit number is not specified, `mdmfs` will automatically select an "
"unused memory device.  For more details about `mdmfs`, refer to man:mdmfs[8]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:1486
#, no-wrap
msgid "File System Snapshots"
msgstr "文件系统快照"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1489
msgid ""
"FreeBSD offers a feature in conjunction with crossref:config[soft-updates,"
"Soft Updates]: file system snapshots."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1491
msgid ""
"UFS snapshots allow a user to create images of specified file systems, and "
"treat them as a file. If you are using the crossref:zfs[,Z file system "
"(ZFS)], refer to crossref:zfs[zfs-zfs-snapshot,\"Managing Snapshots\"] on "
"how to use snapshots."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1496
msgid ""
"Snapshot files must be created in the file system that the action is "
"performed on, and a user may create no more than 20 snapshots per file "
"system.  Active snapshots are recorded in the superblock so they are "
"persistent across unmount and remount operations along with system reboots.  "
"When a snapshot is no longer required, it can be removed using man:rm[1].  "
"While snapshots may be removed in any order, all the used space may not be "
"acquired because another snapshot will possibly claim some of the released "
"blocks."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1499
msgid ""
"The un-alterable `snapshot` file flag is set by man:mksnap_ffs[8] after "
"initial creation of a snapshot file.  man:unlink[1] makes an exception for "
"snapshot files since it allows them to be removed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1502
msgid ""
"Snapshots are created using man:mount[8].  To place a snapshot of [."
"filename]#/var# in the file [.filename]#/var/snapshot/snap#, use the "
"following command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1506
#, no-wrap
msgid "# mount -u -o snapshot /var/snapshot/snap /var\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1509
msgid "Alternatively, use man:mksnap_ffs[8] to create the snapshot:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1513
#, no-wrap
msgid "# mksnap_ffs /var /var/snapshot/snap\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1516
msgid ""
"One can find snapshot files on a file system, such as [.filename]#/var#, "
"using man:find[1]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1520
#, no-wrap
msgid "# find /var -flags snapshot\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1523
msgid "Once a snapshot has been created, it has several uses:"
msgstr "当快照文件被创建好后，可以用于下面一些目的："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1525
msgid ""
"Some administrators will use a snapshot file for backup purposes, because "
"the snapshot can be transferred to CDs or tape."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1526
msgid ""
"The file system integrity checker, man:fsck[8], may be run on the snapshot. "
"Assuming that the file system was clean when it was mounted, this should "
"always provide a clean and unchanging result."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1527
msgid ""
"Running man:dump[8] on the snapshot will produce a dump file that is "
"consistent with the file system and the timestamp of the snapshot. man:"
"dump[8] can also take a snapshot, create a dump image, and then remove the "
"snapshot in one command by using `-L`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1528
msgid ""
"The snapshot can be mounted as a frozen image of the file system. To man:"
"mount[8] the snapshot [.filename]#/var/snapshot/snap# run:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1533
#, no-wrap
msgid ""
"# mdconfig -a -t vnode -o readonly -f /var/snapshot/snap -u 4\n"
"# mount -r /dev/md4 /mnt\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1539
#, fuzzy
msgid ""
"The frozen [.filename]#/var# is now available through [.filename]#/mnt#.  "
"Everything will initially be in the same state it was during the snapshot "
"creation time.  The only exception is that any earlier snapshots will appear "
"as zero length files.  To unmount the snapshot, use:"
msgstr ""
"现在你就可以看到挂接在 <filename>/mnt</filename> 目录下的 <filename>/var</"
"filename> 文件系统的快照。 每一样东西都保存的像它创建时的状态一样。 唯一例外"
"的是更早的快照文件将表现为长度为 0 的文件。 用完快照文件之后可以把它卸下，使"
"用："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1544
#, no-wrap
msgid ""
"# umount /mnt\n"
"# mdconfig -d -u 4\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1547
msgid ""
"For more information about `softupdates` and file system snapshots, "
"including technical papers, visit Marshall Kirk McKusick's website at http://"
"www.mckusick.com/[http://www.mckusick.com/]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:1549
#, no-wrap
msgid "Disk Quotas"
msgstr "文件系统配额"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1553
#, fuzzy
#| msgid ""
#| "Disk quotas can be used to limit the amount of disk space or the number "
#| "of files a user or members of a group may allocate on a per-file system "
#| "basis. This prevents one user or group of users from consuming all of the "
#| "available disk space."
msgid ""
"Disk quotas can be used to limit the amount of disk space or the number of "
"files a user or members of a group may allocate on a per-file system basis.  "
"This prevents one user or group of users from consuming all of the available "
"disk space."
msgstr ""
"配额是操作系统的一个可选的功能， 它允许管理员以文件系统为单元， 限制分派给用"
"户或组成员所使用的磁盘空间大小或是使用的总文件数量。 这经常被用于那些分时操作"
"的系统上， 对于这些系统而言， 通常希望限制分派到每一个用户或组的资源总量， 从"
"而可以防止某个用户占用所有可用的磁盘空间。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1556
msgid ""
"This section describes how to configure disk quotas for the UFS file "
"system.  To configure quotas on the ZFS file system, refer to crossref:"
"zfs[zfs-zfs-quota,\"Dataset, User, and Group Quotas\"]"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1557
#, no-wrap
msgid "Enabling Disk Quotas"
msgstr "启用磁盘配额"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1560
msgid "To determine if the FreeBSD kernel provides support for disk quotas:"
msgstr "查看 FreeBSD 内核是否支持磁盘配额："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1565
#, no-wrap
msgid ""
"% sysctl kern.features.ufs_quota\n"
"kern.features.ufs_quota: 1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1569
msgid ""
"In this example, the `1` indicates quota support.  If the value is instead "
"`0`, add the following line to a custom kernel configuration file and "
"rebuild the kernel using the instructions in crossref:"
"kernelconfig[kernelconfig,Configuring the FreeBSD Kernel]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1573
#, fuzzy, no-wrap
msgid "options QUOTA\n"
msgstr "options QUOTA\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1576
msgid "Next, enable disk quotas in [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1580
#, fuzzy, no-wrap
msgid "quota_enable=\"YES\"\n"
msgstr "quota_enable=\"YES\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1586
msgid ""
"Normally on bootup, the quota integrity of each file system is checked by "
"man:quotacheck[8].  This program insures that the data in the quota database "
"properly reflects the data on the file system.  This is a time consuming "
"process that will significantly affect the time the system takes to boot.  "
"To skip this step, add this variable to [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1590
#, fuzzy, no-wrap
msgid "check_quotas=\"NO\"\n"
msgstr "check_quotas=\"NO\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1595
#, fuzzy
msgid ""
"Finally, edit [.filename]#/etc/fstab# to enable disk quotas on a per-file "
"system basis.  To enable per-user quotas on a file system, add `userquota` "
"to the options field in the [.filename]#/etc/fstab# entry for the file "
"system to enable quotas on.  For example:"
msgstr ""
"最后，要编辑 <filename>/etc/fstab</filename> 文件，以在每一个 文件系统基础上"
"启用磁盘配额。这是启用用户和组配额，或同时启用用户 和组配额的地方。要在一个文"
"件系统上启用每个用户的配额，可以在 <filename>/etc/fstab</filename> 里添加 "
"<option>userquota</option> 选项在要雇用配额文件的系统上。例如："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1599
#, fuzzy, no-wrap
msgid "/dev/da1s2g   /home    ufs rw,userquota 1 2\n"
msgstr "/dev/da1s2g   /home    ufs rw,userquota 1 2\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1603
#, fuzzy
msgid ""
"To enable group quotas, use `groupquota` instead.  To enable both user and "
"group quotas, separate the options with a comma:"
msgstr ""
"同样的，要启用组配额，使用 <option>groupquota</option> 选项来代替 "
"<option>userquota</option> 选项。要同时启用用户和组配额，可以这样做："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1607
#, fuzzy, no-wrap
msgid "/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2\n"
msgstr "/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1612
msgid ""
"By default, quota files are stored in the root directory of the file system "
"as [.filename]#quota.user# and [.filename]#quota.group#.  Refer to man:"
"fstab[5] for more information.  Specifying an alternate location for the "
"quota files is not recommended."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1614
#, fuzzy
msgid ""
"Once the configuration is complete, reboot the system and [.filename]#/etc/"
"rc# will automatically run the appropriate commands to create the initial "
"quota files for all of the quotas enabled in [.filename]#/etc/fstab#."
msgstr ""
"到这儿，可以用新内核重新启动系统。 <filename>/etc/rc</filename> 将自动 运行适"
"当的命令来创建<filename>/etc/fstab</filename>中启用的配额文件。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1617
msgid ""
"In the normal course of operations, there should be no need to manually run "
"man:quotacheck[8], man:quotaon[8], or man:quotaoff[8].  However, one should "
"read these manual pages to be familiar with their operation."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1618
#, no-wrap
msgid "Setting Quota Limits"
msgstr "设置配额限制"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1621
msgid "To verify that quotas are enabled, run:"
msgstr ""
"一旦您配置好了启用配额的系统，可以检查一下它们是真的有用。 可以这样做："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1625
#, no-wrap
msgid "# quota -v\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1628
msgid ""
"There should be a one line summary of disk usage and current quota limits "
"for each file system that quotas are enabled on."
msgstr ""
"您应该能够看到一行当前正在使用的每个文件系统启用的磁盘配额 使用情况的摘要信"
"息。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1630
msgid "The system is now ready to be assigned quota limits with `edquota`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1634
#, fuzzy
#| msgid ""
#| "Several options are available to enforce limits on the amount of disk "
#| "space a user or group may allocate, and how many files they may create. "
#| "Allocations can be limited based on disk space (block quotas), number of "
#| "files (inode quotas), or a combination of both. Each limit is further "
#| "broken down into two categories: hard and soft limits."
msgid ""
"Several options are available to enforce limits on the amount of disk space "
"a user or group may allocate, and how many files they may create.  "
"Allocations can be limited based on disk space (block quotas), number of "
"files (inode quotas), or a combination of both.  Each limit is further "
"broken down into two categories: hard and soft limits."
msgstr ""
"有几个有关如何强制限制用户或组可以分配到的磁盘空间大小的选项。 您可以限制磁盘"
"存储块的配额， 或文件的数量， 甚至同时限制两者。 这些限制最终可分为两类： 硬"
"限制和软限制。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1639
#, fuzzy
#| msgid ""
#| "A hard limit may not be exceeded. Once a user reaches a hard limit, no "
#| "further allocations can be made on that file system by that user. For "
#| "example, if the user has a hard limit of 500 kbytes on a file system and "
#| "is currently using 490 kbytes, the user can only allocate an additional "
#| "10 kbytes. Attempting to allocate an additional 11 kbytes will fail."
msgid ""
"A hard limit may not be exceeded.  Once a user reaches a hard limit, no "
"further allocations can be made on that file system by that user.  For "
"example, if the user has a hard limit of 500 kbytes on a file system and is "
"currently using 490 kbytes, the user can only allocate an additional 10 "
"kbytes.  Attempting to allocate an additional 11 kbytes will fail."
msgstr ""
"硬性限制是一种不能越过的限制。 一旦用户达到了系统指定的硬性限制， 他就无法在"
"对应的文件系统分配到更多的资源。 例如， 如果文件系统上分给用户的硬性限制是 "
"500 KB， 而现在已经用掉了 490 KB， 那么这个用户最多还能再分配 10 KB 的空间。 "
"换言之， 如果这时试图再分配 11 KB， 则会失败。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1643
#, fuzzy
#| msgid ""
#| "Soft limits can be exceeded for a limited amount of time, known as the "
#| "grace period, which is one week by default. If a user stays over their "
#| "limit longer than the grace period, the soft limit turns into a hard "
#| "limit and no further allocations are allowed. When the user drops back "
#| "below the soft limit, the grace period is reset."
msgid ""
"Soft limits can be exceeded for a limited amount of time, known as the grace "
"period, which is one week by default.  If a user stays over their limit "
"longer than the grace period, the soft limit turns into a hard limit and no "
"further allocations are allowed.  When the user drops back below the soft "
"limit, the grace period is reset."
msgstr ""
"软性限制在一段时间内是允许越过的。 这段时间也称为宽限期， 其默认值是一周。 如"
"果一个用户延缓时间太长的话，软限制将会变成硬限制， 而继续分配磁盘空间的操作将"
"被拒绝。 当用户占用的空间回到软性限制值以下时， 宽限期将重新开始计算。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1647
msgid ""
"In the following example, the quota for the `test` account is being edited.  "
"When `edquota` is invoked, the editor specified by `EDITOR` is opened in "
"order to edit the quota limits.  The default editor is set to vi."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1656
#, no-wrap
msgid ""
"# edquota -u test\n"
"Quotas for user test:\n"
"/usr: kbytes in use: 65, limits (soft = 50, hard = 75)\n"
"        inodes in use: 7, limits (soft = 50, hard = 60)\n"
"/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)\n"
"        inodes in use: 0, limits (soft = 50, hard = 60)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1662
#, fuzzy
msgid ""
"There are normally two lines for each file system that has quotas enabled.  "
"One line represents the block limits and the other represents the inode "
"limits.  Change the value to modify the quota limit.  For example, to raise "
"the block limit on [.filename]#/usr# to a soft limit of `500` and a hard "
"limit of `600`, change the values in that line as follows:"
msgstr ""
"在每一个启用了磁盘配额的文件系统上，通常会看到两行。一行是 block 限制，另一行"
"是 inode 限制。简单地改变要修改的配额限制的值。 例如，提高这个用户软限制的数"
"值到 500 ，硬限制到 600，如下所示 ："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1666
#, fuzzy, no-wrap
msgid "/usr: kbytes in use: 65, limits (soft = 500, hard = 600)\n"
msgstr "/usr: kbytes in use: 65, limits (soft = 500, hard = 600)\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1669
msgid "The new quota limits take effect upon exiting the editor."
msgstr "当离开编辑器的时候，新的配额限制设置将会被保存。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1674
msgid ""
"Sometimes it is desirable to set quota limits on a range of users.  This can "
"be done by first assigning the desired quota limit to a user.  Then, use `-"
"p` to duplicate that quota to a specified range of user IDs (UIDs).  The "
"following command will duplicate those quota limits for UIDs `10,000` "
"through `19,999`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1678
#, no-wrap
msgid "# edquota -p test 10000-19999\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1681
msgid "For more information, refer to man:edquota[8]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1682
#, no-wrap
msgid "Checking Quota Limits and Disk Usage"
msgstr "检查配额限制和磁盘使用"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1688
msgid ""
"To check individual user or group quotas and disk usage, use man:quota[1].  "
"A user may only examine their own quota and the quota of a group they are a "
"member of.  Only the superuser may view all user and group quotas.  To get a "
"summary of all quotas and disk usage for file systems with quotas enabled, "
"use man:repquota[8]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1692
msgid ""
"Normally, file systems that the user is not using any disk space on will not "
"show in the output of `quota`, even if the user has a quota limit assigned "
"for that file system.  Use `-v` to display those file systems.  The "
"following is sample output from `quota -v` for a user that has quota limits "
"on two file systems."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1699
#, fuzzy, no-wrap
msgid ""
"Disk quotas for user test (uid 1002):\n"
"     Filesystem  usage    quota   limit   grace   files   quota   limit   grace\n"
"           /usr      65*     50      75   5days       7      50      60\n"
"       /usr/var       0      50      75               0      50      60\n"
msgstr ""
"Disk quotas for user test (uid 1002):\n"
"     Filesystem  usage    quota   limit   grace   files   quota   limit   grace\n"
"           /usr      65*     50      75   5days       7      50      60\n"
"       /usr/var       0      50      75               0      50      60\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1703
#, fuzzy
msgid ""
"In this example, the user is currently 15 kbytes over the soft limit of 50 "
"kbytes on [.filename]#/usr# and has 5 days of grace period left.  The "
"asterisk `*` indicates that the user is currently over the quota limit."
msgstr ""
"前面以 <filename>/usr</filename> 作为例子。 此用户目前已经比软限制 50 KB 超出"
"了 15 KB， 还剩下 5 天的宽限期。 请注意， 星号 <literal>*</literal> 说明用户"
"已经超出了其配额限制。"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1704
#, no-wrap
msgid "Quotas over NFS"
msgstr "通过 NFS 使用磁盘配额"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1708
msgid ""
"Quotas are enforced by the quota subsystem on the NFS server.  The man:rpc."
"rquotad[8] daemon makes quota information available to `quota` on NFS "
"clients, allowing users on those machines to see their quota statistics."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1710
msgid ""
"On the NFS server, enable `rpc.rquotad` by removing the `+#+` from this line "
"in [.filename]*/etc/inetd.conf*:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1714
#, fuzzy, no-wrap
msgid "rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad\n"
msgstr "rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1717
msgid "Then, restart `inetd`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1721
#, no-wrap
msgid "# service inetd restart\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:1724
#, no-wrap
msgid "Encrypting Disk Partitions"
msgstr "加密磁盘分区"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1729
msgid ""
"FreeBSD offers excellent online protections against unauthorized data "
"access.  File permissions and crossref:mac[mac,Mandatory Access Control] "
"(MAC) help prevent unauthorized users from accessing data while the "
"operating system is active and the computer is powered up.  However, the "
"permissions enforced by the operating system are irrelevant if an attacker "
"has physical access to a computer and can move the computer's hard drive to "
"another system to copy and analyze the data."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1733
#, fuzzy
msgid ""
"Regardless of how an attacker may have come into possession of a hard drive "
"or powered-down computer, the GEOM-based cryptographic subsystems built into "
"FreeBSD are able to protect the data on the computer's file systems against "
"even highly-motivated attackers with significant resources.  Unlike "
"encryption methods that encrypt individual files, the built-in `gbde` and "
"`geli` utilities can be used to transparently encrypt entire file systems.  "
"No cleartext ever touches the hard drive's platter."
msgstr ""
"无论攻击者如何取得停机后的硬件或硬盘驱动器本身， FreeBSD <application>GEOM "
"Based Disk Encryption (基于 GEOM 的磁盘加密， gbde)</application> 和 "
"<command>geli</command> 加密子系统都能够保护计算机上的文件系统数据， 使它们免"
"受哪怕是训练有素的攻击者获得有用的资源。 与那些只能加密单个文件的笨重的加密方"
"法不同， <command>gbde</command> 和 <command>geli</command> 能够透明地加密整"
"个文件系统。 明文数据不会出现在硬盘的任何地方。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1736
#, fuzzy
msgid ""
"This chapter demonstrates how to create an encrypted file system on "
"FreeBSD.  It first demonstrates the process using `gbde` and then "
"demonstrates the same example using `geli`."
msgstr ""
"本章演示如何在 FreeBSD 上使用<command>geli</command>和<command>gbde</command>"
"创建加密文件系统。"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1737
#, no-wrap
msgid "Disk Encryption with gbde"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1742
msgid ""
"The objective of the man:gbde[4] facility is to provide a formidable "
"challenge for an attacker to gain access to the contents of a _cold_ storage "
"device.  However, if the computer is compromised while up and running and "
"the storage device is actively attached, or the attacker has access to a "
"valid passphrase, it offers no protection to the contents of the storage "
"device.  Thus, it is important to provide physical security while the system "
"is running and to protect the passphrase used by the encryption mechanism."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1747
msgid ""
"This facility provides several barriers to protect the data stored in each "
"disk sector.  It encrypts the contents of a disk sector using 128-bit AES in "
"CBC mode.  Each sector on the disk is encrypted with a different AES key.  "
"For more information on the cryptographic design, including how the sector "
"keys are derived from the user-supplied passphrase, refer to man:gbde[4]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1749
msgid ""
"FreeBSD provides a kernel module for gbde which can be loaded with this "
"command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1753
#, no-wrap
msgid "# kldload geom_bde\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1756
msgid ""
"If using a custom kernel configuration file, ensure it contains this line:"
msgstr "若使用自定义内核，请在您的内核配置中加入下面一行："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1758
msgid "`options GEOM_BDE`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1760
#, fuzzy
msgid ""
"The following example demonstrates adding a new hard drive to a system that "
"will hold a single encrypted partition that will be mounted as [.filename]#/"
"private#."
msgstr "下面的例子将演示如何将加密分区挂载到<filename>/private</filename>。"

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1762
#, no-wrap
msgid "Procedure: Encrypting a Partition with gbde"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1764
msgid "Add the New Hard Drive"
msgstr "添加新的硬盘"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1767
msgid ""
"Install the new drive to the system as explained in crossref:disks[disks-"
"adding, Adding Disks].  For the purposes of this example, a new hard drive "
"partition has been added as [.filename]#/dev/ad4s1c# and [.filename]#/dev/"
"ad0s1*# represents the existing standard FreeBSD partitions."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1774
#, no-wrap
msgid ""
"# ls /dev/ad*\n"
"/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1\n"
"/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c\n"
"/dev/ad0s1a     /dev/ad0s1d     /dev/ad4\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1777
msgid "Create a Directory to Hold `gbde` Lock Files"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1781
#, no-wrap
msgid "# mkdir /etc/gbde\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1786
#, fuzzy
msgid ""
"The gbde lock file contains information that gbde requires to access "
"encrypted partitions.  Without access to the lock file, gbde will not be "
"able to decrypt the data contained in the encrypted partition without "
"significant manual intervention which is not supported by the software.  "
"Each encrypted partition uses a separate lock file."
msgstr ""
"<application>gbde</application> lock 文件包含了 <application>gbde</"
"application> 需要访问的加密分区的信息。 没有 lock 文件， <application>gbde</"
"application> 将不能解密包含在加密分区上的数据。 每个加密分区使用一个独立的 "
"lock 文件。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1787
msgid "Initialize the `gbde` Partition"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1792
msgid ""
"A gbde partition must be initialized before it can be used.  This "
"initialization needs to be performed only once.  This command will open the "
"default editor, in order to set various configuration options in a "
"template.  For use with the UFS file system, set the sector_size to 2048:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1804
#, no-wrap
msgid ""
"# gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock\n"
"#\n"
"# Sector size is the smallest unit of data which can be read or written.\n"
"# Making it too small decreases performance and decreases available space.\n"
"# Making it too large may prevent filesystems from working.  512 is the\n"
"# minimum and always safe.  For UFS, use the fragment size\n"
"#\n"
"sector_size\t=\t2048\n"
"[...]\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1810
msgid ""
"Once the edit is saved, the user will be asked twice to type the passphrase "
"used to secure the data.  The passphrase must be the same both times.  The "
"ability of gbde to protect data depends entirely on the quality of the "
"passphrase.  For tips on how to select a secure passphrase that is easy to "
"remember, see http://world.std.com/\\~reinhold/diceware.html[http://world."
"std.com/~reinhold/diceware.htm]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1814
msgid ""
"This initialization creates a lock file for the gbde partition.  In this "
"example, it is stored as [.filename]#/etc/gbde/ad4s1c.lock#.  Lock files "
"must end in \".lock\" in order to be correctly detected by the [.filename]#/"
"etc/rc.d/gbde# start up script."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1819
msgid ""
"Lock files _must_ be backed up together with the contents of any encrypted "
"partitions.  Without the lock file, the legitimate owner will be unable to "
"access the data on the encrypted partition."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1822
msgid "Attach the Encrypted Partition to the Kernel"
msgstr "把加密分区和内核进行关联"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1826
#, no-wrap
msgid "# gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1830
#, fuzzy
msgid ""
"This command will prompt to input the passphrase that was selected during "
"the initialization of the encrypted partition.  The new encrypted device "
"will appear in [.filename]#/dev# as [.filename]#/dev/device_name.bde#:"
msgstr ""
"This command will prompt to input the passphrase that was selected during "
"the initialization of the encrypted partition. The new encrypted device will "
"appear in <filename>/dev</filename> as <filename>/dev/device_name.bde</"
"filename>:"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1837
#, no-wrap
msgid ""
"# ls /dev/ad*\n"
"/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1\n"
"/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c\n"
"/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1840
msgid "Create a File System on the Encrypted Device"
msgstr "在加密设备上创建文件系统"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1844
msgid ""
"Once the encrypted device has been attached to the kernel, a file system can "
"be created on the device.  This example creates a UFS file system with soft "
"updates enabled.  Be sure to specify the partition which has a [.filename]#*."
"bde# extension:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1848
#, no-wrap
msgid "# newfs -U /dev/ad4s1c.bde\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1851
msgid "Mount the Encrypted Partition"
msgstr "挂载加密分区"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1853
msgid "Create a mount point and mount the encrypted file system:"
msgstr "为加密文件系统创建一个挂载点："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1858
#, no-wrap
msgid ""
"# mkdir /private\n"
"# mount /dev/ad4s1c.bde /private\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1861
msgid "Verify That the Encrypted File System is Available"
msgstr "验证加密文件系统是否可用"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1863
msgid "The encrypted file system should now be visible and available for use:"
msgstr "现在应该能查看和使用该加密文件系统了："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1874
#, no-wrap
msgid ""
"% df -H\n"
"Filesystem        Size   Used  Avail Capacity  Mounted on\n"
"/dev/ad0s1a      1037M    72M   883M     8%    /\n"
"/devfs            1.0K   1.0K     0B   100%    /dev\n"
"/dev/ad0s1f       8.1G    55K   7.5G     0%    /home\n"
"/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp\n"
"/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr\n"
"/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1878
#, fuzzy
msgid ""
"After each boot, any encrypted file systems must be manually re-attached to "
"the kernel, checked for errors, and mounted, before the file systems can be "
"used.  To configure these steps, add the following lines to [.filename]#/etc/"
"rc.conf#:"
msgstr ""
"每次启动后，必须手动将任何加密文件系统重新附加到内核，检查错误并装载，然后才"
"能使用文件系统。要配置这些步骤，请将以下行添加到<filename>/etc/rc.conf</"
"filename>："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1884
#, no-wrap
msgid ""
"gbde_autoattach_all=\"YES\"\n"
"gbde_devices=\"ad4s1c\"\n"
"gbde_lockdir=\"/etc/gbde\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1889
msgid ""
"This requires that the passphrase be entered at the console at boot time.  "
"After typing the correct passphrase, the encrypted partition will be mounted "
"automatically.  Additional gbde boot options are available and listed in man:"
"rc.conf[5]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1895
msgid ""
"sysinstall is incompatible with gbde-encrypted devices.  All [.filename]#*."
"bde# devices must be detached from the kernel before starting sysinstall or "
"it will crash during its initial probing for devices.  To detach the "
"encrypted device used in the example, use the following command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1899
#, no-wrap
msgid "# gbde detach /dev/ad4s1c\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:1903
#, no-wrap
msgid "Disk Encryption with `geli`"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1908
msgid ""
"An alternative cryptographic GEOM class is available using `geli`.  This "
"control utility adds some features and uses a different scheme for doing "
"cryptographic work.  It provides the following features:"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1910
msgid ""
"Utilizes the man:crypto[9] framework and automatically uses cryptographic "
"hardware when it is available."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1911
msgid ""
"Supports multiple cryptographic algorithms such as AES-XTS, AES-CBC, and "
"Camellia-CBCAES."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1912
msgid ""
"Allows the root partition to be encrypted. The passphrase used to access the "
"encrypted root partition will be requested during system boot."
msgstr "允许对根分区进行加密。 在系统启动时， 将要求输入用于加密根分区的口令。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1913
msgid "Allows the use of two independent keys."
msgstr ""
"允许使用两个不同的密钥 (例如， 一个 <quote>个人密钥</quote> 和一个 <quote>公"
"司密钥</quote>)。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1914
msgid "It is fast as it performs simple sector-to-sector encryption."
msgstr "<command>geli</command> 速度很快 ── 它只进行简单的扇区到扇区的加密。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1915
msgid ""
"Allows backup and restore of master keys. If a user destroys their keys, it "
"is still possible to get access to the data by restoring keys from the "
"backup."
msgstr ""
"允许备份和恢复主密钥。 当用户必须销毁其密钥时， 仍然可以通过从备份中恢复密钥"
"来存取数据。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1916
msgid ""
"Allows a disk to attach with a random, one-time key which is useful for swap "
"partitions and temporary file systems."
msgstr ""
"允许使用随机的一次性密钥来挂接磁盘 ── 这对于交换区和临时文件系统非常有用。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1918
msgid "More features and usage examples can be found in man:geli[8]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1924
#, fuzzy
msgid ""
"The following example describes how to generate a key file which will be "
"used as part of the master key for the encrypted provider mounted under [."
"filename]#/private#.  The key file will provide some random data used to "
"encrypt the master key.  The master key will also be protected by a "
"passphrase.  The provider's sector size will be 4kB.  The example describes "
"how to attach to the `geli` provider, create a file system on it, mount it, "
"work with it, and finally, how to detach it."
msgstr ""
"下面的例子讲描述如何生成密钥文件， 它将作为主密钥 (Master Key) 的一部分， 用"
"于挂接到 <filename>/private</filename> 的加密 provider。 这个密钥文件将提供一"
"些随机数据来加密主密钥。 同时， 主密钥也会使用一个口令字来保护。 Provider 的"
"扇区尺寸为 4kB。 此外， 这里的讨论将介绍如何挂载 <command>geli</command> "
"provider， 在其上创建文件系统， 如何挂接并在其上工作， 最后将其卸下。"

#. type: Block title
#: documentation/content/en/books/handbook/disks/_index.adoc:1926
#, no-wrap
msgid "Procedure: Encrypting a Partition with `geli`"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1928
msgid "Load `geli` Support"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1930
#, fuzzy
msgid ""
"Support for `geli` is available as a loadable kernel module. To configure "
"the system to automatically load the module at boot time, add the following "
"line to [.filename]#/boot/loader.conf#:"
msgstr ""
"geom_eli 内核模块提供了<command>geli</command>支持，若要在系统启动时加载此模"
"块，将这行代码添加到<filename>/boot/loader.conf</filename>中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1934
#, fuzzy, no-wrap
msgid "geom_eli_load=\"YES\"\n"
msgstr "geom_eli_load=\"YES\"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1937
msgid "To load the kernel module now:"
msgstr "现在，加载内核模块："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1941
#, no-wrap
msgid "# kldload geom_eli\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1944
msgid ""
"For a custom kernel, ensure the kernel configuration file contains these "
"lines:"
msgstr "若使用自定义内核，请确保内核配置文件中有以下两行："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1949
#, fuzzy, no-wrap
msgid ""
"options GEOM_ELI\n"
"device crypto\n"
msgstr ""
"options GEOM_ELI\n"
"device crypto\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1952
msgid "Generate the Master Key"
msgstr "生成主密钥"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1959
#, fuzzy
msgid ""
"The following commands generate a master key that all data will be encrypted "
"with.  This key can never be changed.  Rather than using it directly, it is "
"encrypted with one or more user keys.  The user keys are made up of an "
"optional combination of random bytes from a file, [.filename]#/root/da2."
"key#, and/or a passphrase.  In this case, the data source for the key file "
"is [.filename]#/dev/random#.  This command also configures the sector size "
"of the provider ([.filename]#/dev/da2.eli#) as 4kB, for better performance:"
msgstr ""
"下面的命令会生成一个主密钥，所有的数据都会使用该密钥加密。这个密钥永远不能被"
"改变。不要直接使用它，而是用一个或多个用户密钥进行加密。用户密钥由<filename>/"
"root/da2.key</filename>中随机字节的可选组合或密码组成。在这种情况下，密钥文件"
"的数据源是<filename>/dev/random</filename>。该命令还将 Provider 的扇区大小"
"(<filename>/dev/da2.eli</filename>)配置为4kB，以提高性能："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1966
#, no-wrap
msgid ""
"# dd if=/dev/random of=/root/da2.key bs=64 count=1\n"
"# geli init -K /root/da2.key -s 4096 /dev/da2\n"
"Enter new passphrase:\n"
"Reenter new passphrase:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1969
msgid ""
"It is not mandatory to use both a passphrase and a key file as either method "
"of securing the master key can be used in isolation."
msgstr ""
"同时使用口令字和密钥文件并不是必须的； 您也可以只使用其中的一种来加密主密钥。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1972
msgid ""
"If the key file is given as \"-\", standard input will be used.  For "
"example, this command generates three key files:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1976
#, no-wrap
msgid "# cat keyfile1 keyfile2 keyfile3 | geli init -K - /dev/da2\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1979
msgid "Attach the Provider with the Generated Key"
msgstr "将 provider 与所生成的密钥关联"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1981
msgid ""
"To attach the provider, specify the key file, the name of the disk, and the "
"passphrase:"
msgstr "若要访问 Provider，请指定密钥文件、磁盘名称和密码："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1986
#, no-wrap
msgid ""
"# geli attach -k /root/da2.key /dev/da2\n"
"Enter passphrase:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1989
msgid "This creates a new device with an [.filename]#.eli# extension:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:1994
#, no-wrap
msgid ""
"# ls /dev/da2*\n"
"/dev/da2  /dev/da2.eli\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1997
msgid "Create the New File System"
msgstr "创建新的文件系统"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:1999
msgid ""
"Next, format the device with the UFS file system and mount it on an existing "
"mount point:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2005
#, no-wrap
msgid ""
"# dd if=/dev/random of=/dev/da2.eli bs=1m\n"
"# newfs /dev/da2.eli\n"
"# mount /dev/da2.eli /private\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2008
msgid "The encrypted file system should now be available for use:"
msgstr "加密文件系统现在应该可以使用了："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2019
#, no-wrap
msgid ""
"# df -H\n"
"Filesystem     Size   Used  Avail Capacity  Mounted on\n"
"/dev/ad0s1a    248M    89M   139M    38%    /\n"
"/devfs         1.0K   1.0K     0B   100%    /dev\n"
"/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr\n"
"/dev/ad0s1d    989M   1.5M   909M     0%    /tmp\n"
"/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var\n"
"/dev/da2.eli   150G   4.1K   138G     0%    /private\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2022
#, fuzzy
msgid ""
"Once the work on the encrypted partition is done, and the [.filename]#/"
"private# partition is no longer needed, it is prudent to put the device into "
"cold storage by unmounting and detaching the `geli` encrypted partition from "
"the kernel:"
msgstr ""
"一旦在加密分区上的工作完成， 并且不再需要 <filename>/private</filename> 分"
"区， 就应考虑将其卸下并将 <command>geli</command> 加密分区从内核上断开，并将"
"数据持久化："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2027
#, no-wrap
msgid ""
"# umount /private\n"
"# geli detach da2.eli\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2030
msgid ""
"An [.filename]#rc.d# script is provided to simplify the mounting of `geli`-"
"encrypted devices at boot time. For this example, add these lines to [."
"filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2035
#, no-wrap
msgid ""
"geli_devices=\"da2\"\n"
"geli_da2_flags=\"-k /root/da2.key\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2045
msgid ""
"This configures [.filename]#/dev/da2# as a `geli` provider with a master key "
"of [.filename]#/root/da2.key#.  The system will automatically detach the "
"provider from the kernel before the system shuts down.  During the startup "
"process, the script will prompt for the passphrase before attaching the "
"provider.  Other kernel messages might be shown before and after the "
"password prompt.  If the boot process seems to stall, look carefully for the "
"password prompt among the other messages.  Once the correct passphrase is "
"entered, the provider is attached.  The file system is then mounted, "
"typically by an entry in [.filename]#/etc/fstab#.  Refer to crossref:"
"basics[mount-unmount,“Mounting and Unmounting File Systems”] for "
"instructions on how to configure a file system to mount at boot time."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:2047
#, no-wrap
msgid "Encrypting Swap"
msgstr "对交换区进行加密"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2054
#, fuzzy
#| msgid ""
#| "Like the encryption of disk partitions, encryption of swap space is used "
#| "to protect sensitive information. Consider an application that deals with "
#| "passwords. As long as these passwords stay in physical memory, they are "
#| "not written to disk and will be cleared after a reboot. However, if "
#| "FreeBSD starts swapping out memory pages to free space, the passwords may "
#| "be written to the disk unencrypted. Encrypting swap space can be a "
#| "solution for this scenario."
msgid ""
"Like the encryption of disk partitions, encryption of swap space is used to "
"protect sensitive information.  Consider an application that deals with "
"passwords.  As long as these passwords stay in physical memory, they are not "
"written to disk and will be cleared after a reboot.  However, if FreeBSD "
"starts swapping out memory pages to free space, the passwords may be written "
"to the disk unencrypted.  Encrypting swap space can be a solution for this "
"scenario."
msgstr ""
"与加密磁盘分区类似， 加密交换区有助于保护敏感信息。 为此， 我们不妨考虑一个需"
"要处理敏感信息的程序， 例如， 它需要处理口令。 如果这些口令一直保持在物理内存"
"中， 则一切相安无事。 然而， 如果操作系统开始将内存页换出到交换区， 以便为其"
"他应用程序腾出内存时， 这些口令就可能以未加密的形式写到磁盘上， 并为攻击者所"
"轻易获得。 加密交换区能够有效地解决这类问题。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2057
msgid ""
"This section demonstrates how to configure an encrypted swap partition using "
"man:gbde[8] or man:geli[8] encryption.  It assumes that [.filename]#/dev/"
"ada0s1b# is the swap partition."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:2058
#, no-wrap
msgid "Configuring Encrypted Swap"
msgstr "配置加密的交换分区"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2062
#, fuzzy
#| msgid ""
#| "Swap partitions are not encrypted by default and should be cleared of any "
#| "sensitive data before continuing. To overwrite the current swap partition "
#| "with random garbage, execute the following command:"
msgid ""
"Swap partitions are not encrypted by default and should be cleared of any "
"sensitive data before continuing.  To overwrite the current swap partition "
"with random garbage, execute the following command:"
msgstr ""
"到目前为止， 交换区仍是未加密的。 很可能其中已经存有明文形式的口令或其他敏感"
"数据。 要纠正这一问题， 首先应使用随机数来覆盖交换分区的数据："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2066
#, no-wrap
msgid "# dd if=/dev/random of=/dev/ada0s1b bs=1m\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2069
msgid ""
"To encrypt the swap partition using man:gbde[8], add the `.bde` suffix to "
"the swap line in [.filename]#/etc/fstab#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2074
#, fuzzy, no-wrap
msgid ""
"# Device\t\tMountpoint\tFStype\tOptions\t\tDump\tPass#\n"
"/dev/ada0s1b.bde\tnone\t\tswap\tsw\t\t0\t0\n"
msgstr ""
"# Device\t\tMountpoint\tFStype\tOptions\t\tDump\tPass#\n"
"/dev/ada0s1b.bde\tnone\t\tswap\tsw\t\t0\t0\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2077
msgid ""
"To instead encrypt the swap partition using man:geli[8], use the `.eli` "
"suffix:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2082
#, fuzzy, no-wrap
msgid ""
"# Device\t\tMountpoint\tFStype\tOptions\t\tDump\tPass#\n"
"/dev/ada0s1b.eli\tnone\t\tswap\tsw\t\t0\t0\n"
msgstr ""
"# Device\t\tMountpoint\tFStype\tOptions\t\tDump\tPass#\n"
"/dev/ada0s1b.eli\tnone\t\tswap\tsw\t\t0\t0\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2087
msgid ""
"By default, man:geli[8] uses the AES algorithm with a key length of 128 "
"bits.  Normally the default settings will suffice.  If desired, these "
"defaults can be altered in the options field in [.filename]#/etc/fstab#. The "
"possible flags are:"
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/disks/_index.adoc:2088
#, no-wrap
msgid "aalgo"
msgstr "aalgo"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2091
msgid ""
"Data integrity verification algorithm used to ensure that the encrypted data "
"has not been tampered with.  See man:geli[8] for a list of supported "
"algorithms."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/disks/_index.adoc:2092
#, no-wrap
msgid "ealgo"
msgstr "ealgo"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2095
msgid ""
"Encryption algorithm used to protect the data.  See man:geli[8] for a list "
"of supported algorithms."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/disks/_index.adoc:2096
#, no-wrap
msgid "keylen"
msgstr "keylen"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2099
msgid ""
"The length of the key used for the encryption algorithm.  See man:geli[8] "
"for the key lengths that are supported by each encryption algorithm."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/disks/_index.adoc:2100
#, no-wrap
msgid "sectorsize"
msgstr "sectorsize"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2104
#, fuzzy
#| msgid ""
#| "The size of the blocks data is broken into before it is encrypted. Larger "
#| "sector sizes increase performance at the cost of higher storage overhead. "
#| "The recommended size is 4096 bytes."
msgid ""
"The size of the blocks data is broken into before it is encrypted.  Larger "
"sector sizes increase performance at the cost of higher storage overhead.  "
"The recommended size is 4096 bytes."
msgstr ""
"数据在加密之前需分块（扇区）。扇区尺寸越大，性能越高，存储开销越高。建议的大"
"小为 4096 字节。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2106
#, fuzzy
#| msgid ""
#| "This example configures an encrypted swap partition using the Blowfish "
#| "algorithm with a key length of 128 bits and a sectorsize of 4 kilobytes:"
msgid ""
"This example configures an encrypted swap partition using the AES-XTS "
"algorithm with a key length of 128 bits and a sectorsize of 4 kilobytes:"
msgstr ""
"本示例使用密钥长度为 128 位的 Blowfish 算法配置加密交换分区，其扇区大小为 4 "
"KB："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2111
#, fuzzy, no-wrap
msgid ""
"# Device\t\tMountpoint\tFStype\tOptions\t\t\t\tDump\tPass#\n"
"/dev/ada0s1b.eli\tnone\t\tswap\tsw,ealgo=AES-XTS,keylen=128,sectorsize=4096\t0\t0\n"
msgstr ""
"# Device\t\tMountpoint\tFStype\tOptions\t\t\t\tDump\tPass#\n"
"/dev/ada0s1b.eli\tnone\t\tswap\tsw,ealgo=blowfish,keylen=128,sectorsize=4096\t0\t0\n"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:2113
#, no-wrap
msgid "Encrypted Swap Verification"
msgstr "验证所作的配置能够发挥作用"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2116
msgid ""
"Once the system has rebooted, proper operation of the encrypted swap can be "
"verified using `swapinfo`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2118
msgid "If man:gbde[8] is being used:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2124
#, no-wrap
msgid ""
"% swapinfo\n"
"Device          1K-blocks     Used    Avail Capacity\n"
"/dev/ada0s1b.bde   542720        0   542720     0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2127
msgid "If man:geli[8] is being used:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2133
#, no-wrap
msgid ""
"% swapinfo\n"
"Device          1K-blocks     Used    Avail Capacity\n"
"/dev/ada0s1b.eli   542720        0   542720     0\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/disks/_index.adoc:2136
#, no-wrap
msgid "Highly Available Storage (HAST)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2142
#, fuzzy
msgid ""
"High availability is one of the main requirements in serious business "
"applications and highly-available storage is a key component in such "
"environments.  In FreeBSD, the Highly Available STorage (HAST) framework "
"allows transparent storage of the same data across several physically "
"separated machines connected by a TCP/IP network.  HAST can be understood as "
"a network-based RAID1 (mirror), and is similar to the DRBD(R) storage system "
"used in the GNU/Linux(R) platform.  In combination with other high-"
"availability features of FreeBSD like CARP, HAST makes it possible to build "
"a highly-available storage cluster that is resistant to hardware failures."
msgstr ""
"高可用性是担负关键业务的应用的一项主要需求， 而高可用存储则是这类环境中的一项"
"关键组件。 高可用存储 Highly Available STorage， 或 <acronym>HAST</"
"acronym>， 是由 Paweł Jakub Dawidek 开发的一种用于提供在两台物理上隔离的系统"
"之间以透明的方式， 通过 TCP/IP 网络传输数据的高可用性框架。 <acronym>HAST</"
"acronym> 可以看作通过网络进行的 RAID1 (镜像)， 类似于 GNU/<trademark class="
"\"registered\">Linux</trademark> 平台上的 DRBD® 存储系统。 配合 FreeBSD 提供"
"的其他高可用性基础设施， 如 <acronym>CARP</acronym>， <acronym>HAST</"
"acronym> 可以用来构建可以抗御硬件故障的高可用存储集群。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2144
msgid "The following are the main features of HAST:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2146
msgid "Can be used to mask I/O errors on local hard drives."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2147
msgid ""
"File system agnostic as it works with any file system supported by FreeBSD."
msgstr "文件系统无关， 因而可以配合 FreeBSD 支持的任何文件系统使用。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2148
msgid ""
"Efficient and quick resynchronization as only the blocks that were modified "
"during the downtime of a node are synchronized."
msgstr "高效率的快速重新同步机制， 令系统只同步在另一节点停机时修改过的块。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2149
msgid ""
"Can be used in an already deployed environment to add additional redundancy."
msgstr "可以在已经部署好的环境中添加冗余。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2150
msgid ""
"Together with CARP, Heartbeat, or other tools, it can be used to build a "
"robust and durable storage system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2152
msgid "After reading this section, you will know:"
msgstr "读完这节， 您将了解："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2154
msgid "What HAST is, how it works, and which features it provides."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2155
msgid "How to set up and use HAST on FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2156
msgid "How to integrate CARP and man:devd[8] to build a robust storage system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2158
msgid "Before reading this section, you should:"
msgstr "在阅读这节之前， 您应了解："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2160
msgid ""
"Understand UNIX(R) and FreeBSD basics (crossref:basics[basics,FreeBSD "
"Basics])."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2161
msgid ""
"Know how to configure network interfaces and other core FreeBSD subsystems "
"(crossref:config[config-tuning,Configuration and Tuning])."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2162
msgid ""
"Have a good understanding of FreeBSD networking (crossref:partiv[network-"
"communication,\"Network Communication\"])."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2164
msgid ""
"The HAST project was sponsored by The FreeBSD Foundation with support from "
"http://www.omc.net/[http://www.omc.net/] and http://www.transip.nl/[http://"
"www.transip.nl/]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:2165
#, no-wrap
msgid "HAST Operation"
msgstr "HAST 的运行机制"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2169
msgid ""
"HAST provides synchronous block-level replication between two physical "
"machines: the _primary_ node and the _secondary_ node.  These two machines "
"together are referred to as a cluster."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2173
msgid ""
"Since HAST works in a primary-secondary configuration, it allows only one of "
"the cluster nodes to be active at any given time.  The primary node, also "
"called _active_, is the one which will handle all the I/O requests to HAST-"
"managed devices.  The secondary node is automatically synchronized from the "
"primary node."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2175
msgid ""
"The physical components of the HAST system are the local disk on primary "
"node, and the disk on the remote, secondary node."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2179
msgid ""
"HAST operates synchronously on a block level, making it transparent to file "
"systems and applications.  HAST provides regular GEOM providers in [."
"filename]#/dev/hast/# for use by other tools or applications.  There is no "
"difference between using HAST-provided devices and raw disks or partitions."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2183
#, fuzzy
msgid ""
"Each write, delete, or flush operation is sent to both the local disk and to "
"the remote disk over TCP/IP.  Each read operation is served from the local "
"disk, unless the local disk is not up-to-date or an I/O error occurs.  In "
"such cases, the read operation is sent to the secondary node."
msgstr ""
"发到本地磁盘的每次写、 删除或缓存刷写操作， 都会同时通过 TCP/IP 发到远程磁盘"
"上。 读操作是由本地磁盘完成， 除非本地磁盘上的数据不是最新的， 或发生了 I/O "
"错误。 在这种情况下， 读操作会在从节点上完成。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2187
#, fuzzy
msgid ""
"HAST tries to provide fast failure recovery.  For this reason, it is "
"important to reduce synchronization time after a node's outage.  To provide "
"fast synchronization, HAST manages an on-disk bitmap of dirty extents and "
"only synchronizes those during a regular synchronization, with an exception "
"of the initial sync."
msgstr ""
"<acronym>HAST</acronym> 希望提供快速的故障恢复能力。 基于这一考量， 减少在某"
"个节点停机后需要的同步时间就十分重要。 为了提供快速的同步能力， "
"<acronym>HAST</acronym> 会维护一份保存在磁盘上的脏区段位映射表 (bitmap of "
"dirty extents)， 在普通的同步模式中， 它只同步这些部分的数据 (初始的同步除"
"外)。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2190
msgid ""
"There are many ways to handle synchronization.  HAST implements several "
"replication modes to handle different synchronization methods:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2192
#, fuzzy
msgid ""
"_memsync_: This mode reports a write operation as completed when the local "
"write operation is finished and when the remote node acknowledges data "
"arrival, but before actually storing the data. The data on the remote node "
"will be stored directly after sending the acknowledgement. This mode is "
"intended to reduce latency, but still provides good reliability. This mode "
"is the default."
msgstr ""
"<emphasis>memsync</emphasis>： 当本地的写操作已经完成， 并且远程节点汇报已经"
"收到数据时， 便认为数据的写操作已经完成， 而不是等待远程节点完成数据的写操"
"作。 远程节点在发出回应之后， 会立即开始执行写操作。 这种模式的目标是减少响应"
"时间， 但在同时仍然保持很好的可靠性。 目前 <emphasis>memsync</emphasis> 复制"
"模式尚未实现。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2193
msgid ""
"_fullsync_: This mode reports a write operation as completed when both the "
"local write and the remote write complete. This is the safest and the "
"slowest replication mode."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2194
#, fuzzy
msgid ""
"_async_: This mode reports a write operation as completed when the local "
"write completes. This is the fastest and the most dangerous replication "
"mode. It should only be used when replicating to a distant node where "
"latency is too high for other modes."
msgstr ""
"<emphasis>async</emphasis>： 在本地写操作完成时， 即认为数据已经写完。 这是最"
"快， 同时也是风险最大的复制模式， 一般而言只有在另一节点的延迟较大时才应考虑"
"使用。 目前 <emphasis>async</emphasis> 复制模式尚未实现。"

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:2195
#, no-wrap
msgid "HAST Configuration"
msgstr "HAST 的配置"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2198
msgid "The HAST framework consists of several components:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2200
msgid ""
"The man:hastd[8] daemon which provides data synchronization. When this "
"daemon is started, it will automatically load `geom_gate.ko`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2201
msgid "The userland management utility, man:hastctl[8]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2202
msgid ""
"The man:hast.conf[5] configuration file. This file must exist before "
"starting hastd."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2204
msgid ""
"Users who prefer to statically build `GEOM_GATE` support into the kernel "
"should add this line to the custom kernel configuration file, then rebuild "
"the kernel using the instructions in crossref:kernelconfig[kernelconfig,"
"Configuring the FreeBSD Kernel]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2208
#, fuzzy, no-wrap
msgid "options\tGEOM_GATE\n"
msgstr "options\tGEOM_GATE\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2214
msgid ""
"The following example describes how to configure two nodes in primary-"
"secondary operation using HAST to replicate the data between the two.  The "
"nodes will be called `hasta`, with an IP address of `172.16.0.1`, and "
"`hastb`, with an IP address of `172.16.0.2`.  Both nodes will have a "
"dedicated hard drive [.filename]#/dev/ad6# of the same size for HAST "
"operation.  The HAST pool, sometimes referred to as a resource or the GEOM "
"provider in [.filename]#/dev/hast/#, will be called `test`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2218
msgid ""
"Configuration of HAST is done using [.filename]#/etc/hast.conf#.  This file "
"should be identical on both nodes.  The simplest configuration is:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2231
#, no-wrap
msgid ""
"resource test {\n"
"\ton hasta {\n"
"\t\tlocal /dev/ad6\n"
"\t\tremote 172.16.0.2\n"
"\t}\n"
"\ton hastb {\n"
"\t\tlocal /dev/ad6\n"
"\t\tremote 172.16.0.1\n"
"\t}\n"
"}\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2234
msgid "For more advanced configuration, refer to man:hast.conf[5]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2238
msgid ""
"It is also possible to use host names in the `remote` statements if the "
"hosts are resolvable and defined either in [.filename]#/etc/hosts# or in the "
"local DNS."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2242
msgid ""
"Once the configuration exists on both nodes, the HAST pool can be created.  "
"Run these commands on both nodes to place the initial metadata onto the "
"local disk and to start man:hastd[8]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2247
#, no-wrap
msgid ""
"# hastctl create test\n"
"# service hastd onestart\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2253
msgid ""
"It is _not_ possible to use GEOM providers with an existing file system or "
"to convert an existing storage to a HAST-managed pool.  This procedure needs "
"to store some metadata on the provider and there will not be enough required "
"space available on an existing provider."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2257
msgid ""
"A HAST node's `primary` or `secondary` role is selected by an administrator, "
"or software like Heartbeat, using man:hastctl[8].  On the primary node, "
"`hasta`, issue this command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2261
#, no-wrap
msgid "# hastctl role primary test\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2264
msgid "Run this command on the secondary node, `hastb`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2268
#, no-wrap
msgid "# hastctl role secondary test\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2271
msgid "Verify the result by running `hastctl` on each node:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2275
#, no-wrap
msgid "# hastctl status test\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2281
msgid ""
"Check the `status` line in the output.  If it says `degraded`, something is "
"wrong with the configuration file.  It should say `complete` on each node, "
"meaning that the synchronization between the nodes has started.  The "
"synchronization completes when `hastctl status` reports 0 bytes of `dirty` "
"extents."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2286
msgid ""
"The next step is to create a file system on the GEOM provider and mount it.  "
"This must be done on the `primary` node.  Creating the file system can take "
"a few minutes, depending on the size of the hard drive.  This example "
"creates a UFS file system on [.filename]#/dev/hast/test#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2292
#, no-wrap
msgid ""
"# newfs -U /dev/hast/test\n"
"# mkdir /hast/test\n"
"# mount /dev/hast/test /hast/test\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2296
msgid ""
"Once the HAST framework is configured properly, the final step is to make "
"sure that HAST is started automatically during system boot.  Add this line "
"to [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2300
#, fuzzy, no-wrap
msgid "hastd_enable=\"YES\"\n"
msgstr "hastd_enable=\"YES\"\n"

#. type: Title ====
#: documentation/content/en/books/handbook/disks/_index.adoc:2302
#, no-wrap
msgid "Failover Configuration"
msgstr "故障转移配置"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2306
#, fuzzy
#| msgid ""
#| "The goal of this example is to build a robust storage system which is "
#| "resistant to the failure of any given node. If the primary node fails, "
#| "the secondary node is there to take over seamlessly, check and mount the "
#| "file system, and continue to work without missing a single bit of data."
msgid ""
"The goal of this example is to build a robust storage system which is "
"resistant to the failure of any given node.  If the primary node fails, the "
"secondary node is there to take over seamlessly, check and mount the file "
"system, and continue to work without missing a single bit of data."
msgstr ""
"这个例子的目标是建立一个健壮的存储系统，它可以抵抗任何一个节点的故障。如果主"
"节点发生故障，副节点将无缝接管，检查和挂载文件系统，并继续工作，不会丢失任何"
"数据。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2312
msgid ""
"To accomplish this task, the Common Address Redundancy Protocol (CARP) is "
"used to provide for automatic failover at the IP layer.  CARP allows "
"multiple hosts on the same network segment to share an IP address.  Set up "
"CARP on both nodes of the cluster according to the documentation available "
"in crossref:advanced-networking[carp,“Common Address Redundancy Protocol "
"(CARP)”].  In this example, each node will have its own management IP "
"address and a shared IP address of _172.16.0.254_.  The primary HAST node of "
"the cluster must be the primary CARP node."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2316
msgid ""
"The HAST pool created in the previous section is now ready to be exported to "
"the other hosts on the network.  This can be accomplished by exporting it "
"through NFS or Samba, using the shared IP address _172.16.0.254_.  The only "
"problem which remains unresolved is an automatic failover should the primary "
"node fail."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2320
msgid ""
"In the event of CARP interfaces going up or down, the FreeBSD operating "
"system generates a man:devd[8] event, making it possible to watch for state "
"changes on the CARP interfaces.  A state change on the CARP interface is an "
"indication that one of the nodes failed or came back online.  These state "
"change events make it possible to run a script which will automatically "
"handle the HAST failover."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2322
msgid ""
"To catch state changes on the CARP interfaces, add this configuration to [."
"filename]#/etc/devd.conf# on each node, while replacing `<vhid>` with the "
"virtual host id and `<ifname>` with the associated interface name:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2331
#, fuzzy, no-wrap
msgid ""
"notify 30 {\n"
"\tmatch \"system\" \"CARP\";\n"
"\tmatch \"subsystem\" \"<vhid>@<ifname>\";\n"
"\tmatch \"type\" \"MASTER\";\n"
"\taction \"/usr/local/sbin/carp-hast-switch primary\";\n"
"};\n"
msgstr ""
"notify 100 {\n"
"\tmatch \"system\" \"GEOM\";\n"
"\tmatch \"subsystem\" \"DEV\";\n"
"\taction \"/usr/sbin/automount -c\";\n"
"};\n"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2338
#, fuzzy, no-wrap
msgid ""
"notify 30 {\n"
"\tmatch \"system\" \"CARP\";\n"
"\tmatch \"subsystem\" \"<vhid>@<ifname>\";\n"
"\tmatch \"type\" \"BACKUP\";\n"
"\taction \"/usr/local/sbin/carp-hast-switch secondary\";\n"
"};\n"
msgstr ""
"notify 100 {\n"
"\tmatch \"system\" \"GEOM\";\n"
"\tmatch \"subsystem\" \"DEV\";\n"
"\taction \"/usr/sbin/automount -c\";\n"
"};\n"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2341
msgid ""
"Restart man:devd[8] on both nodes to put the new configuration into effect:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2345
#, no-wrap
msgid "# service devd restart\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2349
msgid ""
"When the specified interface state changes by going up or down , the system "
"generates a notification, allowing the man:devd[8] subsystem to run the "
"specified automatic failover script, [.filename]#/usr/local/sbin/carp-hast-"
"switch#.  For further clarification about this configuration, refer to man:"
"devd.conf[5]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2351
msgid "Here is an example of an automated failover script:"
msgstr "下面是一个这种脚本的示例："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2355
#, no-wrap
msgid "#!/bin/sh\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2359
#, no-wrap
msgid ""
"# Original script by Freddie Cash <fjwcash@gmail.com>\n"
"# Modified by Michael W. Lucas <mwlucas@BlackHelicopters.org>\n"
"# and Viktor Petersson <vpetersson@wireload.net>\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2362
#, no-wrap
msgid ""
"# The names of the HAST resources, as listed in /etc/hast.conf\n"
"resources=\"test\"\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2366
#, no-wrap
msgid ""
"# delay in mounting HAST resource after becoming primary\n"
"# make your best guess\n"
"delay=3\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2370
#, no-wrap
msgid ""
"# logging\n"
"log=\"local0.debug\"\n"
"name=\"carp-hast\"\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2372
#, no-wrap
msgid "# end of user configurable stuff\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2377
#, no-wrap
msgid ""
"case \"$1\" in\n"
"\tprimary)\n"
"\t\tlogger -p $log -t $name \"Switching to primary provider for ${resources}.\"\n"
"\t\tsleep ${delay}\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2383
#, no-wrap
msgid ""
"\t\t# Wait for any \"hastd secondary\" processes to stop\n"
"\t\tfor disk in ${resources}; do\n"
"\t\t\twhile $( pgrep -lf \"hastd: ${disk} \\(secondary\\)\" > /dev/null 2>&1 ); do\n"
"\t\t\t\tsleep 1\n"
"\t\t\tdone\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2391
#, no-wrap
msgid ""
"\t\t\t# Switch role for each disk\n"
"\t\t\thastctl role primary ${disk}\n"
"\t\t\tif [ $? -ne 0 ]; then\n"
"\t\t\t\tlogger -p $log -t $name \"Unable to change role to primary for resource ${disk}.\"\n"
"\t\t\t\texit 1\n"
"\t\t\tfi\n"
"\t\tdone\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2398
#, no-wrap
msgid ""
"\t\t# Wait for the /dev/hast/* devices to appear\n"
"\t\tfor disk in ${resources}; do\n"
"\t\t\tfor I in $( jot 60 ); do\n"
"\t\t\t\t[ -c \"/dev/hast/${disk}\" ] && break\n"
"\t\t\t\tsleep 0.5\n"
"\t\t\tdone\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2404
#, no-wrap
msgid ""
"\t\t\tif [ ! -c \"/dev/hast/${disk}\" ]; then\n"
"\t\t\t\tlogger -p $log -t $name \"GEOM provider /dev/hast/${disk} did not appear.\"\n"
"\t\t\t\texit 1\n"
"\t\t\tfi\n"
"\t\tdone\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2406
#, no-wrap
msgid "\t\tlogger -p $log -t $name \"Role for HAST resources ${resources} switched to primary.\"\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2413
#, no-wrap
msgid ""
"\t\tlogger -p $log -t $name \"Mounting disks.\"\n"
"\t\tfor disk in ${resources}; do\n"
"\t\t\tmkdir -p /hast/${disk}\n"
"\t\t\tfsck -p -y -t ufs /dev/hast/${disk}\n"
"\t\t\tmount /dev/hast/${disk} /hast/${disk}\n"
"\t\tdone\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2415
#, no-wrap
msgid "\t;;\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2418
#, no-wrap
msgid ""
"\tsecondary)\n"
"\t\tlogger -p $log -t $name \"Switching to secondary provider for ${resources}.\"\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2436
#, no-wrap
msgid ""
"\t\t# Switch roles for the HAST resources\n"
"\t\tfor disk in ${resources}; do\n"
"\t\t\tif ! mount | grep -q \"^/dev/hast/${disk} on \"\n"
"\t\t\tthen\n"
"\t\t\telse\n"
"\t\t\t\tumount -f /hast/${disk}\n"
"\t\t\tfi\n"
"\t\t\tsleep $delay\n"
"\t\t\thastctl role secondary ${disk} 2>&1\n"
"\t\t\tif [ $? -ne 0 ]; then\n"
"\t\t\t\tlogger -p $log -t $name \"Unable to switch role to secondary for resource ${disk}.\"\n"
"\t\t\t\texit 1\n"
"\t\t\tfi\n"
"\t\t\tlogger -p $log -t $name \"Role switched to secondary for resource ${disk}.\"\n"
"\t\tdone\n"
"\t;;\n"
"esac\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2439
#, fuzzy
#| msgid ""
#| "In a nutshell, the script takes these actions when a node becomes master:"
msgid ""
"In a nutshell, the script takes these actions when a node becomes primary:"
msgstr ""
"简而言之， 在节点成为网络的 <literal>master</literal> / <literal>primary</"
"literal> 节点时， 脚本会进行下面的操作："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2441
msgid "Promotes the HAST pool to primary on the other node."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2442
msgid "Checks the file system under the HAST pool."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2443
msgid "Mounts the pool."
msgstr "挂接存储池。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2445
msgid "When a node becomes secondary:"
msgstr "当节点变为辅助节点时："

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2447
msgid "Unmounts the HAST pool."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2448
msgid "Degrades the HAST pool to secondary."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2453
#, fuzzy
#| msgid ""
#| "This is just an example script which serves as a proof of concept. It "
#| "does not handle all the possible scenarios and can be extended or altered "
#| "in any way, for example, to start or stop required services."
msgid ""
"This is just an example script which serves as a proof of concept.  It does "
"not handle all the possible scenarios and can be extended or altered in any "
"way, for example, to start or stop required services."
msgstr ""
"务必注意， 上面的脚本只是概念性的介绍。 它并不能处理所有可能发生的情况， 因此"
"应根据实际情况进行修改， 例如启动/停止必要的服务， 等等。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2459
msgid ""
"For this example, a standard UFS file system was used.  To reduce the time "
"needed for recovery, a journal-enabled UFS or ZFS file system can be used "
"instead."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2462
msgid ""
"Instead of using the highly available storage locally, it can also be shared "
"to other computers on a network via crossref:network-servers[network-nfs,"
"NFS], crossref:network-servers[network-iscsi,iSCSI], man:sshfs[1], or "
"programs in ports (i.e. package:net/samba419[])."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2464
msgid ""
"More detailed information with additional examples can be found at http://"
"wiki.FreeBSD.org/HAST[http://wiki.FreeBSD.org/HAST]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/disks/_index.adoc:2465
#, no-wrap
msgid "Troubleshooting"
msgstr "故障排除"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2470
#, fuzzy
msgid ""
"HAST should generally work without issues.  However, as with any other "
"software product, there may be times when it does not work as supposed.  The "
"sources of the problems may be different, but the rule of thumb is to ensure "
"that the time is synchronized between the nodes of the cluster."
msgstr ""
"<acronym>HAST</acronym> 通常都能够无故障地运行， 不过， 和任何其他软件产品一"
"样， 有时它也可能会无法以希望的方式运转。 导致问题的可能性有很多， 但一般来"
"说， 首先要确保集群中所有节点的时间是同步的。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2474
msgid ""
"When troubleshooting HAST, the debugging level of man:hastd[8] should be "
"increased by starting `hastd` with `-d`.  This argument may be specified "
"multiple times to further increase the debugging level.  Consider also using "
"`-F`, which starts `hastd` in the foreground."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/disks/_index.adoc:2476
#, no-wrap
msgid "Recovering from the Split-brain Condition"
msgstr "从脑分裂状态恢复"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2481
#, fuzzy
msgid ""
"_Split-brain_ occurs when the nodes of the cluster are unable to communicate "
"with each other, and both are configured as primary.  This is a dangerous "
"condition because it allows both nodes to make incompatible changes to the "
"data.  This problem must be corrected manually by the system administrator."
msgstr ""
"当集群中的两个节点之间无法相互通讯时， 两个节点都会认为自己是主节点， 从而导"
"致 <literal>脑分裂</literal> 的状态。 这种情形十分危险， 因为两个节点会产生互"
"相无法合并的数据。 这种情形需要系统管理员实施手工干预。"

#. type: Plain text
#: documentation/content/en/books/handbook/disks/_index.adoc:2485
#, fuzzy
msgid ""
"The administrator must either decide which node has more important changes, "
"or perform the merge manually.  Then, let HAST perform full synchronization "
"of the node which has the broken data.  To do this, issue these commands on "
"the node which needs to be resynchronized:"
msgstr ""
"从这种状态中恢复时， 管理员必须决定哪一个节点包含最重要的数据变动 (或者手工合"
"并这些改动) 并让 <acronym>HAST</acronym> 进行一次完整的同步操作， 覆盖有问题"
"的那个节点的数据。 要完成这个工作，在有问题的节点上执行下面的命令："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/disks/_index.adoc:2491
#, no-wrap
msgid ""
"# hastctl role init test\n"
"# hastctl create test\n"
"# hastctl role secondary test\n"
msgstr ""
